{"version":3,"sources":["../../.tmp/js/angularApp.js"],"names":[],"mappings":"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","file":"angularApp.js","sourcesContent":["\n\n/**\n * Main module of the application.\n */\n\n/*\n//executes a function which every item in the array has\nArray.prototype.callForEach = function(key) {\n  var args = arguments.slice(1);\n  this.forEach(function(item) {\n    item.prototype[key].apply(item, args);\n  });\n};\n\nArray.prototype.returnForEach = function(keys) { //String, e.i. 'data.elementId' to get an array with every item.data.elementId\n  return this.map(function(item) {\n    var allKeys = keys.split('.');\n    var toReturn = item;\n\n    allKeys.forEach(function(key) {\n      toReturn = toReturn[key];\n    });\n\n    return toReturn;\n  });\n};\n*/\n\n\nvar app = angular.module('GMAO Tailor', [ 'ngRoute', 'ui.router', 'ngMaterial' ]);\n\napp.config(['$urlRouterProvider', '$stateProvider', '$locationProvider', 'USER_ROLES', function($urlRouterProvider, $stateProvider, $locationProvider, USER_ROLES) {\n\n  /*$locationProvider.html5Mode({\n      enabled: true,\n      requireBase: false\n  });*/\n\n  // For any unmatched url, redirect to /home\n  $urlRouterProvider.otherwise(function($injector, $location) {\n    window.location.replace('/home');\n  });\n\n  // Now set up the states\n  $stateProvider\n    .state('auth', {\n      url: '^/auth',\n      templateUrl: 'templates/states/auth.html',\n      controller: 'AuthCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.all\n      }\n    })\n    .state('profile', {\n      url: '^/profile',\n      templateUrl: 'templates/states/profile.html',\n      controller: 'ProfileCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers\n      }\n    })\n    .state('blueprint', {\n      url: '^/blueprint?blueprintId&id&version', //blueprintId only if it's a new element\n      templateUrl: 'templates/states/blueprint.html',\n      controller: 'BlueprintCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers\n      }\n    })\n    .state('blueprints-private', {\n      url: '^/blueprints/private?selectCategory&searchGroups&searchGroupsSelect',\n      templateUrl: 'templates/states/objects.html',\n      controller: 'ObjectsCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers,\n        name: 'blueprint',\n        visibility: 'private',\n        filters: []\n      }\n    })\n    .state('blueprints-public', {\n      url: '^/blueprints/public',\n      templateUrl: 'templates/states/objects.html',\n      controller: 'ObjectsCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers,\n        name: 'blueprint',\n        visibility: 'public',\n        filters: []\n      }\n    })\n    .state('element', {\n      url: '^/element?id&version',\n      templateUrl: 'templates/states/element.html',\n      controller: 'ElementCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers\n      }\n    })\n    .state('elements-private', {\n      url: '^/elements/private?selectCategory&searchGroups&searchGroupsSelect',\n      templateUrl: 'templates/states/objects.html',\n      controller: 'ObjectsCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers,\n        name: 'element',\n        visibility: 'private',\n        filters: []\n      }\n    })\n    .state('elements-public', {\n      url: '^/elements/public',\n      templateUrl: 'templates/states/objects.html',\n      controller: 'ObjectsCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers,\n        name: 'element',\n        visibility: 'public',\n        filters: []\n      }\n    })\n    .state('group', {\n      url: '^/group?id',\n      templateUrl: 'templates/states/group.html',\n      controller: 'GroupCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers\n      }\n    })\n    .state('groups-private', {\n      url: '^/groups/private?selectCategory&searchGroups&searchGroupsSelect',\n      templateUrl: 'templates/states/objects.html',\n      controller: 'ObjectsCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers,\n        name: 'group',\n        visibility: 'private',\n        filters: [\n          {\n            name: 'Members Name',\n            value: 'members.user.name'\n          },\n          {\n            name: 'Members Level',\n            value: 'members.level'\n          }\n        ]\n      }\n    })\n    .state('groups-public', {\n      url: '^/groups/public',\n      templateUrl: 'templates/states/objects.html',\n      controller: 'ObjectsCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers,\n        name: 'group',\n        visibility: 'public',\n        filters: [\n          {\n            name: 'Members Name',\n            value: 'members.user.name'\n          },\n          {\n            name: 'Members Level',\n            value: 'members.level'\n          }\n        ]\n      }\n    })\n    .state('graph', {\n      url: '^/graph/:id',\n      templateUrl: 'templates/states/graph.html',\n      controller: 'GraphCtrl',\n      data: {\n        authorizedRoles: USER_ROLES.allUsers\n      }\n    });\n\n}])\n\n/* Doesn't work\n\n.config([ '$provide', function($provide) { //$q returns a promise which can be reach with then(fn, fn, fn) and now with success(fn) and error(fn)\n\n  $provide.decorator('$q', [ '$delegate', function($delegate) {\n    var defer = $delegate.defer;\n    $delegate.defer = function() {\n      var deferred = defer();\n      deferred.promise.success = function(fn) {\n        deferred.promise.then(function(response) {\n          fn(response.data, response.status, response.headers);\n        });\n      return deferred.promise;\n      };\n      deferred.promise.error = function(fn) {\n        deferred.promise.then(null, function(response) {\n          fn(response.data, response.status, response.headers);\n        });\n        return deferred.promise;\n      };\n      return deferred;\n    };\n    return $delegate;\n  }]);\n\n}])\n\n*/\n\n.run([ '$window', '$rootScope', 'AUTH_EVENTS', 'USER_ROLES', 'AuthService', function($window, $rootScope, AUTH_EVENTS, USER_ROLES, AuthService) {\n\n  function stateChangeStart() {\n    $rootScope.$on('$stateChangeStart', function(event, next) {\n\n      var authorizedRoles = next.data.authorizedRoles;\n\n      if (!AuthService.isAuthorized(authorizedRoles) && authorizedRoles !== USER_ROLES.all) {\n        event.preventDefault();\n\n        if (AuthService.isAuthenticated()) {\n          //user is not allowed\n          $rootScope.$broadcast(AUTH_EVENTS.notAuthorized);\n\n        } else {\n          //user is not logged in so he will need to log in or register\n          $rootScope.$broadcast(AUTH_EVENTS.notAuthenticated, next.name);\n        }\n      }\n    });\n  }\n\n  //if there is a token then auto log in\n  if ($window.localStorage.token) {\n    AuthService.currentUser(stateChangeStart); //defer until auto log in\n  } else {\n    stateChangeStart();\n  }\n}])\n\n.config([ '$httpProvider', function($httpProvider) {\n  $httpProvider.interceptors.push([\n    '$injector',\n    function($injector) {\n      return $injector.get('AuthInterceptor');\n    }\n  ]);\n}])\n\n.factory('AuthInterceptor', [ '$window', '$rootScope', '$q', 'AUTH_EVENTS', function($window, $rootScope, $q, AUTH_EVENTS) {\n\n  return {\n\n    request: function (config) {\n      config.headers = config.headers || {};\n      if ($window.localStorage.token) {\n        config.headers.authorization = 'Bearer ' + $window.localStorage.token;\n      }\n      return config;\n    },\n\n    responseError: function(response) {\n      if (response.status == 419 || response.status == 440) delete $window.localStorage.token;\n\n      if ([ 401, 403, 419, 440 ].indexOf(response.status) > -1) {\n        $rootScope.$broadcast({\n          401: AUTH_EVENTS.notAuthenticated,\n          403: AUTH_EVENTS.notAuthorized,\n          419: AUTH_EVENTS.sessionTimeout,\n          440: AUTH_EVENTS.sessionTimeout\n        }[response.status], response);\n\n        return $q.reject(response);\n      }\n    }\n  };\n}]);\n\r\n\r\n\r\nangular.module('GMAO Tailor').controller('ConfirmDeleteDialogCtrl', ['$scope', '$mdDialog', function($scope, $mdDialog) {\r\n\r\n  $scope.name = name;\r\n\r\n  $scope.cancel = function() {\r\n    $mdDialog.cancel();\r\n  };\r\n  $scope.validate = function() {\r\n    $mdDialog.hide();\r\n  };\r\n\r\n}]);\r\n\r\n\r\n\r\nangular.module('GMAO Tailor').controller('NewLayerDialogCtrl', ['$scope', '$timeout', '$mdDialog', function($scope, $timeout, $mdDialog) {\r\n\r\n  $scope.layer = {}; //the new layer\r\n\r\n  function focus() {\r\n    document.getElementById('newLayerName').focus();\r\n  }\r\n  $timeout(focus, 501);\r\n\r\n  $scope.hide = function() {\r\n    $mdDialog.hide();\r\n  };\r\n  $scope.cancel = function() {\r\n    $mdDialog.cancel();\r\n  };\r\n  $scope.validate = function() {\r\n    $mdDialog.hide($scope.layer);\r\n  };\r\n\r\n}]);\r\n\r\n\r\n\r\nangular.module('GMAO Tailor').controller('UpdateChatDialogCtrl', ['$scope', '$timeout', '$mdDialog', 'chat', function($scope, $timeout, $mdDialog, chat) {\r\n\r\n  $scope.chat = chat;\r\n\r\n  function focus() {\r\n    document.getElementById('updateChatName').focus();\r\n  }\r\n  $timeout(focus, 501);\r\n\r\n  $scope.hide = function() {\r\n    $mdDialog.hide();\r\n  };\r\n\r\n  $scope.cancel = function() {\r\n    $mdDialog.cancel();\r\n  };\r\n\r\n  $scope.validate = function() {\r\n    $mdDialog.hide($scope.chat);\r\n  };\r\n\r\n\r\n  $scope.search = {\r\n    text: {\r\n      members: ''\r\n    },\r\n    select: {\r\n      members: '$'\r\n    }\r\n  };\r\n\r\n  $scope.addMembers = {\r\n    members: [],\r\n    searchText: '',\r\n    selectedItem: '',\r\n    filter: function(user, index, array) {\r\n      if (user.name.toLowerCase().indexOf($scope.addMembers.searchText.toLowerCase()) > -1 && user._id !== $scope.currentUser._id) {\r\n        return $scope.chat.members.every(function(member) {\r\n          return member.user._id !== user._id;\r\n        });\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n\r\n  $scope.lastMessage = function(memberId) {\r\n    var lastMessage = {\r\n      content: '',\r\n      createdAt: 0\r\n    };\r\n\r\n    $scope.chat.messages.forEach(function(message) {\r\n      if (message.author === memberId) {\r\n        if (lastMessage.createdAt <= message.createdAt) lastMessage = message;\r\n      }\r\n    });\r\n\r\n    return lastMessage.content;\r\n  };\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').constant('AUTH_EVENTS', {\r\n\r\n    updateUserSuccess: 'update-user-success',\r\n\r\n    loginSuccess: 'auth-login-success',\r\n\r\n    loginFailed: 'auth-login-failed',\r\n\r\n    registerSuccess: 'auth-register-success',\r\n\r\n    registerFailed: 'auth-register-failed',\r\n\r\n    sessionTimeout: 'auth-session-timeout',\r\n\r\n    notAuthenticated: 'auth-not-authenticated',\r\n\r\n    notAuthorized: 'auth-not-authorized'\r\n\r\n});\r\n\r\n\r\nangular.module('GMAO Tailor').constant('USER_ROLES', {\r\n\r\n    all: '*', //absolutely anyone even visitors\r\n\r\n    allUsers: [ 'user', 'modo', 'admin' ], //anyone logged in\r\n\r\n    user: ['user'],\r\n\r\n    modo: ['modo'],\r\n\r\n    admin: ['admin']\r\n\r\n});\r\n\r\n\r\nangular.module('GMAO Tailor').constant('CONTEXTMENUCONTENT', [\r\n\r\n    {\r\n      name: 'Comparators',\r\n      content: [ 'egal', 'higher', 'lower', 'higherOrEgal', 'lowerOrEgal' ]\r\n    },\r\n\r\n    {\r\n      name: 'Functions',\r\n      content: [\r\n        {\r\n          name: 'Array',\r\n          content: [ 'indexOf' ]\r\n        },\r\n\r\n        {\r\n          name: 'String',\r\n          content: [ 'concat', 'matchByString', 'matchByRegHex' ]\r\n        }\r\n      ]\r\n    },\r\n\r\n    {\r\n      name: 'Opperators',\r\n      content: [ 'addition', 'substraction', 'multiplication', 'division', 'modulo' ]\r\n    },\r\n\r\n    {\r\n      name: 'Parameters',\r\n      content: [ 'boolOption', 'enum', 'property', 'RegHex', 'selection' ]\r\n    },\r\n\r\n    {\r\n      name: 'Primary',\r\n      content: [ 'array', 'bool', 'date', 'number', 'object', 'string' ]\r\n    },\r\n\r\n    {\r\n      name: 'User Inputs',\r\n      content: [ 'Input_Array', 'Input_Blueprint', 'Input_Boolean', 'Input_Date', 'Input_Number', 'Input_Object', 'Input_Selector', 'Input_String' ]\r\n    },\r\n\r\n    {\r\n      name: 'Variables',\r\n      content: [ 'parameter', 'return' ]\r\n    }\r\n\r\n]);\r\n\r\n\r\nangular.module('GMAO Tailor').controller('AppCtrl', ['$scope', '$http', '$state', '$mdMedia', 'Toast', 'AUTH_EVENTS', 'Socket', function($scope, $http, $state, $mdMedia, Toast, AUTH_EVENTS, Socket) {\r\n\r\n  $scope.sidenavLeft = {};\r\n  $scope.sidenavRight = {};\r\n  $scope.currentUser = null;\r\n  $scope.socket = Socket;\r\n  var toState = '';\r\n\r\n  function setCurrentUser(event, user) {\r\n    //backdrop hidden when higher than min-width\r\n    $scope.sidenavLeft = { open: $scope.sidenavLeft.open || $mdMedia('min-width: 640px') };\r\n    $scope.sidenavRight = { open: $scope.sidenavRight.open || $mdMedia('min-width: 960px') };\r\n\r\n    $scope.currentUser = user;\r\n\r\n    if (toState !== '') {\r\n      $state.go(toState);\r\n      toState = '';\r\n\r\n    } else {\r\n      if ($state.is('auth')) $state.go('elements-private'); //for the time being\r\n    }\r\n  }\r\n\r\n  function onLogIn(event, user) {\r\n    $scope.socket.connect();\r\n    setCurrentUser(event, user);\r\n  }\r\n\r\n  $scope.searchFilter = function(selectBy, search) {\r\n    var expression = {};\r\n    expression[selectBy] = search; //ex: { id: 48} => every item with this property, only,  will be shown\r\n    return expression;\r\n  };\r\n\r\n  $scope.defContacts = function(type) { //type === 'users' or 'groups'\r\n    var typeCapitalized = type.charAt(0).toUpperCase() + type.slice(1);\r\n\r\n    if (typeof $scope[ 'all' + typeCapitalized ] === 'undefined') {\r\n      $http\r\n        .get('/api/' + type + '/all')\r\n        .success(function(contacts) {\r\n          console.log('success contacts', contacts);\r\n          typeCapitalized = type.charAt(0).toUpperCase() + type.slice(1); //need to be redefined because it can change during the time before success is called\r\n\r\n          $scope[ 'all' + typeCapitalized ] = contacts;\r\n          $scope[ 'all' + typeCapitalized + 'Object' ] = {}; //easier to load contacts from a Blueprint\r\n          contacts.forEach(function(contact) {\r\n            $scope[ 'all' + typeCapitalized + 'Object' ][contact._id] = contact;\r\n          });\r\n        })\r\n        .error(function(err) {\r\n          console.log(err);\r\n          Toast.error(err);\r\n        });\r\n    }\r\n  };\r\n\r\n  $scope.$on(AUTH_EVENTS.loginSuccess, onLogIn);\r\n  $scope.$on(AUTH_EVENTS.registerSuccess, onLogIn);\r\n  $scope.$on(AUTH_EVENTS.updateUserSuccess, setCurrentUser);\r\n\r\n  $scope.$on(AUTH_EVENTS.notAuthenticated, function(event, wantedState) {\r\n    //the state where the user wanted to go\r\n    Toast.error('You need to log in to access this page.');\r\n    $scope.currentUser = null;\r\n    $state.go('auth');\r\n  });\r\n\r\n  $scope.$on(AUTH_EVENTS.sessionTimeout, function(event, response) {\r\n    Toast.error(response.data);\r\n    $scope.currentUser = null;\r\n    $scope.socket.disconnect();\r\n    $state.go('auth', {}, { reload: true, inherit: false });\r\n  });\r\n\r\n}]);\r\n\r\n\n/**\n * Footer Controller\n */\n\nangular.module('GMAO Tailor').controller('AppFooterCtrl', ['$scope', function($scope) {\n\n}]);\n\r\n\n/**\n * Header Controller\n */\n\nangular.module('GMAO Tailor').controller('AppHeaderCtrl', ['$scope', '$state', '$mdSidenav', function($scope, $state, $mdSidenav) {\n\n  //resize canvas to avoid bug on elements size\n  function resizeCanvas() { //duplicata from BlueprintCtrl\n    var event = document.createEvent('Event');\n\n    // Define that the event name is 'build'.\n    event.initEvent('resize', true, true);\n\n    // target can be any Element or other EventTarget.\n    window.dispatchEvent(event);\n  }\n\n  $scope.isState = function(stateName) {\n    return $state.is(stateName);\n  };\n\n  $scope.toggleSidenav = function(navId) {\n    $mdSidenav(navId) //easier to delay the resize (too soon otherwise)\n      .toggle()\n      .then(function(event, sidenav) {\n        if ($scope.isState('blueprint')) resizeCanvas();\n      });\n  };\n\n}]);\n\r\n\r\nangular.module('GMAO Tailor').controller('SidenavCtrl', [ '$scope', '$state', '$mdDialog', 'AuthService', function($scope, $state, $mdDialog, AuthService) {\r\n\r\n  //because ui-sref=\"blueprint\" ui-sref-opts=\"{ reload: true, inherit: false }\" for instance doesn't work\r\n  $scope.goToNew = function(stateName) {\r\n    $state.go(stateName, {}, { reload: true, inherit: false });\r\n  };\r\n\r\n  $scope.logout = AuthService.logout;\r\n\r\n\r\n  //CHAT\r\n\r\n  $scope.authenticated = false;\r\n\r\n  $scope.current = {\r\n    tab: 0,\r\n    chat: null,\r\n    message: ''\r\n  };\r\n\r\n  $scope.search = {\r\n    text: {\r\n      chats: '',\r\n      chatGroups: ''\r\n    },\r\n    select: {\r\n      chatGroups: ''\r\n    }\r\n  };\r\n\r\n  $scope.addChat = {\r\n    name: null,\r\n    members: [],\r\n    selectedItem: '',\r\n    searchText: '',\r\n    filter: function(user, index, array) {\r\n      if (user.name.toLowerCase().indexOf($scope.addChat.searchText.toLowerCase()) > -1 && $scope.currentUser._id !== user._id) {\r\n        return $scope.addChat.members.every(function(member) {\r\n          return member._id !== user._id;\r\n        });\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n\r\n  function scrollDownMessages() {\r\n    var messages = document.getElementById('messages');\r\n    messages.scrollTop = messages.scrollHeight;\r\n  }\r\n\r\n  $scope.socket.onAuthentification(function(socket, data) {\r\n    $scope.chats = data.chats;\r\n    $scope.chatGroups = data.chatGroups;\r\n    $scope.defContacts('users');\r\n\r\n    $scope.current.chat = $scope.chats[0] || $scope.chatGroups[0] || null;\r\n    scrollDownMessages();\r\n\r\n    $scope.updateChat = function(event, chat) {\r\n      var oldChat = {\r\n        name: chat.name,\r\n        members: chat.members.slice(),\r\n        _id: chat._id\r\n      };\r\n\r\n      $mdDialog.show({\r\n        controller: 'UpdateChatDialogCtrl',\r\n        templateUrl: 'templates/components/updateChatDialog.html',\r\n        parent: angular.element(document.body),\r\n        targetEvent: event, // TODO:\r\n        clickOutsideToClose: true,\r\n        locals: { chat: chat }\r\n      })\r\n      .then(function(chatUpdated) { //given by $mdDialog.hide()\r\n        if (chatUpdated.name !== oldChat.name || chatUpdated.members !== oldChat.members) {\r\n          socket.emit('updateChat', chatUpdated);\r\n          console.log('emit updateChat');\r\n        }\r\n      }, function() { //cancel\r\n        //nothing to do\r\n      });\r\n    };\r\n\r\n    socket.on('message', function(data) {\r\n      console.log('new message received');\r\n\r\n      var chat = $scope[data.type].find(function(chat) {\r\n        return chat._id === data._id;\r\n      });\r\n\r\n      if (chat.messages.length > 0) {\r\n        var lastMessage = chat.messages[chat.messages.length - 1];\r\n\r\n        if (lastMessage.createdAt === data.message.createdAt && data.message.content.indexOf(lastMessage.content) > -1) {\r\n          console.log('success');\r\n          lastMessage.content = data.message.content;\r\n        } else {\r\n          chat.messages.push(data.message);\r\n        }\r\n      } else {\r\n        chat.messages.push(data.message);\r\n      }\r\n\r\n      if ($scope.current.chat === chat) scrollDownMessages();\r\n    });\r\n\r\n    $scope.send = function() {\r\n      var type = (typeof $scope.current.chat.groupId !== 'undefined') ? 'chatGroups' : 'chats';\r\n      socket.emit('message', { type: type, _id: $scope.current.chat._id, message: $scope.current.message });\r\n      $scope.current.message = '';\r\n      console.log('new message sent');\r\n    };\r\n\r\n    $scope.loadChat = function(chat) {\r\n      $scope.current.chat = chat;\r\n      scrollDownMessages();\r\n      $scope.current.tab = 0;\r\n    };\r\n\r\n    socket.on('quitChat', function(data) { //still need data.type because if the group corresponding to the chat is updated, the current user may not be a member of the group afterward, the same goes for the chatGroup\r\n      console.log('on quitChat');\r\n      if (data.userId === $scope.currentUser._id) {\r\n        $scope[data.type] = $scope[data.type].filter(function(chat) {\r\n          return chat._id !== data._id;\r\n        });\r\n      } else {\r\n        $scope[data.type].forEach(function(chat) {\r\n          if (chat._id === data._id) {\r\n            chat.members = chat.members.filter(function(member) {\r\n              return member._id !== $scope.currentUser._id;\r\n            });\r\n          }\r\n        });\r\n      }\r\n\r\n      if ($scope.current.chat) {\r\n        if ($scope.current.chat._id === data._id) $scope.current.chat = null;\r\n      }\r\n    });\r\n\r\n    $scope.quitChat = function(chat) {\r\n      socket.emit('quitChat', chat._id);\r\n      console.log('emit quitChat');\r\n    };\r\n\r\n    socket.on('chat', function(chat) {\r\n      console.log('new chat received');\r\n      var chats = (typeof chat.groupId !== 'undefined') ? $scope.chatGroups : $scope.chats;\r\n\r\n      var existingChat = chats.find(function(chatFilter) {\r\n        return chatFilter._id === chat._id;\r\n      });\r\n\r\n      if (existingChat) {\r\n        existingChat = chat;\r\n      } else {\r\n        chats.push(chat);\r\n      }\r\n\r\n      $scope.loadChat(chat);\r\n    });\r\n\r\n    $scope.addChat.submit = function() {\r\n      var ids = $scope.addChat.members.map(function(member) {\r\n        return member._id;\r\n      });\r\n\r\n      socket.emit('chat', { name: $scope.addChat.name || null, members: ids });\r\n      console.log('new chat sent');\r\n    };\r\n\r\n    function memberUpdate(userId, isConnected) {\r\n      [ 'chats', 'chatGroups' ].forEach(function(type) {\r\n        $scope[type].forEach(function(chat) {\r\n          chat.members.forEach(function(member) {\r\n            if (member._id === userId) member.status = isConnected;\r\n          });\r\n        });\r\n      });\r\n      $scope.$apply();\r\n    }\r\n\r\n    socket.on('userConnection', function(userId) {\r\n      memberUpdate(userId, true);\r\n    });\r\n\r\n    socket.on('userDisconnection', function(userId) {\r\n      memberUpdate(userId, false);\r\n    });\r\n\r\n\r\n    //other socket.io emit/on\r\n  });\r\n\r\n}]);\r\n\r\n\nangular.module('GMAO Tailor').controller('AuthCtrl', [ '$scope', 'Toast', 'AuthService', function($scope, Toast, AuthService) {\n\n  $scope.loginSubmit = function() {\n    AuthService.login($scope.login, function(err, user) {\n      if (err) {\n        console.log(err);\n        Toast.error(err);\n      }\n    });\n  };\n\n  $scope.registerSubmit = function() {\n    AuthService.register($scope.register, function(err, user) {\n      if (err) {\n        console.log(err);\n        Toast.error(err);\n      }\n    });\n  };\n\n}]);\n\r\n\r\nangular.module('GMAO Tailor').controller('BlueprintCtrl', [ '$scope', '$http', '$timeout', '$state', 'Dialog', 'Toast', 'Element', 'Layer', 'Global', 'AllInstances', function($scope, $http, $timeout, $state, Dialog, Toast, Element, Layer, Global, AllInstances) {\r\n\r\n  // Canvas\r\n    $scope.blueprintCanvasId = 'blueprintCanvas';\r\n    paper.install(window); //Make the paper scope global, by injecting it into window\r\n    paper.setup($scope.blueprintCanvasId);\r\n\r\n\r\n  // Network Related\r\n    function httpBlueprint(method, action, params, versionName) {\r\n      var config = {\r\n        method: method,\r\n        url: '/api/blueprint/' + action\r\n      };\r\n      config[ (method.toLowerCase() === 'get') ? 'params' : 'data' ] = params;\r\n\r\n      $http(config)\r\n        .success(function(blueprint) {\r\n          console.log('success httpBlueprint', blueprint);\r\n          $scope.blueprint = blueprint;\r\n\r\n          $scope.loadBlueprint(versionName, true);\r\n        })\r\n        .error(function(err) {\r\n          console.log(err);\r\n          Toast.error(err);\r\n        });\r\n    }\r\n\r\n    function readBlueprint(id, versionName) {\r\n      httpBlueprint('GET', 'read', { id: id }, versionName);\r\n    }\r\n\r\n    $scope.loadBlueprint = function(versionName, hideToast) {\r\n      var version = $scope.blueprint.versions.find(function(version) { return version.name === versionName; }) || $scope.blueprint.versions[$scope.blueprint.versions.length - 1];\r\n\r\n      //update url params without reload the state\r\n      $state.transitionTo('.', { id: $scope.blueprint._id, version: version.name }, { location: true, inherit: true, relative: $state.$current, notify: false });\r\n\r\n      $scope.elementInstance.deleteAll(); //delete all elements because they belong to a previous loaded version\r\n      $scope.elementInstance.draw(version.elements);\r\n\r\n      $scope.layerInstance.all = $scope.layerInstance.all.slice(0, 2); //return the 2 firsts layers ('All' and 'Selected') because they belong to the previous loaded version\r\n      $scope.layerInstance.import(version.layers);\r\n\r\n      $scope.elementInstance.connections.removeAll();\r\n      $scope.elementInstance.connections.import(version.connectionss);\r\n\r\n      $scope.current = {\r\n        tab: 0,\r\n        versionName: version.name,\r\n        versionsName: $scope.blueprint.versions.map(function(version) { return version.name; }),\r\n        notes: version.notes,\r\n        todo: version.todo,\r\n        layer: $scope.layerInstance.all[0],\r\n        element: {},\r\n        definition: {}\r\n      };\r\n\r\n      if (!hideToast) Toast.success($scope.blueprint.name + ' (' + version.name + ') has been loaded !');\r\n    };\r\n\r\n    $scope.saveBlueprint = function() {\r\n      var action = (typeof $scope.blueprint._id === 'undefined') ? 'write' : 'update';\r\n\r\n      var blueprint = {\r\n        name: $scope.blueprint.name,\r\n        description: $scope.blueprint.description,\r\n        access: $scope.blueprint.access,\r\n        tags: $scope.blueprint.tags,\r\n        _id: $scope.blueprint._id,\r\n        version: {\r\n          name: $scope.current.versionName,\r\n          notes: $scope.current.notes,\r\n          todo: $scope.current.todo,\r\n          elements: $scope.elementInstance.drawnOnesArray,\r\n          layers: $scope.layerInstance.export($scope.layerInstance.all),\r\n          connectionss: $scope.elementInstance.connections.export()\r\n        }\r\n      };\r\n\r\n      console.log('$scope.blueprint', $scope.blueprint);\r\n\r\n      httpBlueprint('POST', action, { blueprint: blueprint }, $scope.current.versionName);\r\n\r\n      Toast.success($scope.blueprint.name + ' has been saved !');\r\n    };\r\n\r\n    $scope.deleteBlueprint = function(ev) {\r\n      Dialog\r\n        .confirmDelete(ev, 'Blueprint')\r\n        .then(function() { //success : the user decides to crush down his blueprint\r\n          $http\r\n            .delete('/api/blueprint/delete', { params: { id: $scope.blueprint._id } })\r\n            .success(function() {\r\n              $state.go('blueprints-private');\r\n            })\r\n            .error(function(err) {\r\n              console.log(err);\r\n              Toast.error(err);\r\n            });\r\n        });\r\n    };\r\n\r\n\r\n  // Default objects\r\n    $scope.blueprint = {\r\n      name: '',\r\n      description: '',\r\n      tags: [],\r\n      author: {\r\n        name: $scope.currentUser.name,\r\n        _id: $scope.currentUser._id\r\n      },\r\n      versions: [],\r\n      access: {\r\n        public: {\r\n          blueprint: {\r\n            read: false,\r\n            update: false,\r\n            delete: false\r\n          },\r\n          instance: {\r\n            write: false\r\n          }\r\n        },\r\n        users: [],\r\n        groups: []\r\n      },\r\n      userAccess: {\r\n        blueprint: {\r\n          read: true,\r\n          update: true,\r\n          delete: true\r\n        },\r\n        instance: {\r\n          write: true\r\n        }\r\n      }\r\n    };\r\n\r\n\r\n  // Fetch blueprint if params\r\n    if (typeof $state.params.id !== 'undefined') readBlueprint($state.params.id, $state.params.version); //fetch the blueprint\r\n\r\n\r\n  // Helpers properties\r\n    $scope.current = {\r\n      tab: 0,\r\n      versionName: '0.0.0',\r\n      versionsName: [],\r\n      notes: '',\r\n      todo: '',\r\n      layer: $scope.layerInstance.all[0],\r\n      element: {},\r\n      definition: {}\r\n    };\r\n\r\n    $scope.search = {\r\n      text: {\r\n        accessUsers: '',\r\n        layers: '',\r\n        layer: '',\r\n        documentation: ''\r\n      },\r\n      select: {\r\n        accessUsers: '$',\r\n        layers: '$',\r\n        layer: '$',\r\n        documentation: '$'\r\n      }\r\n    };\r\n\r\n\r\n\r\n  // Right Sidenav View Helpers\r\n    function loadElement(element) {\r\n      $scope.current.element = element;\r\n      $scope.current.definition = element.getDefinition();\r\n    }\r\n\r\n    $scope.openProperties = function(element) {\r\n      loadElement(element);\r\n      $scope.current.tab = 4;\r\n    };\r\n\r\n    $scope.openDocumentation = function(element) {\r\n      loadElement(element);\r\n      $scope.current.tab = 5;\r\n    };\r\n\r\n    $scope.openLayer = function(layer) {\r\n      $scope.current.layer = layer;\r\n      $scope.current.tab = 3;\r\n    };\r\n\r\n    $scope.isCurrentElementDefined = function() {\r\n      return typeof $scope.current.element._id !== 'undefined';\r\n    };\r\n\r\n    $scope.versionValidation = function() {\r\n      var pattern = new RegExp('^(?:(\\d+)\\.)?(?:(\\d+)\\.)?(\\*|\\d+)$');\r\n      return pattern.match($scope.current.version);\r\n    };\r\n\r\n    $scope.displayArrayOf = function(type) {\r\n      return (type.indexOf('All') > -1) ? 'All' : type.join(' | ');\r\n    };\r\n\r\n    $scope.allElementAre = function(elementsId, propertyName) {\r\n      var isInData = typeof AllInstances.element[elementsId[0]].components.data[propertyName] !== 'undefined';\r\n\r\n      if (isInData) {\r\n        return elementsId.every(function(elementId) {\r\n          return AllInstances.element[elementId].components.data[propertyName];\r\n        });\r\n      } else {\r\n        return elementsId.every(function(elementId) {\r\n          return AllInstances.element[elementId].components[propertyName];\r\n        });\r\n      }\r\n    };\r\n\r\n\r\n\r\n  //Access Rights\r\n    $scope.defaultRights = {\r\n      user: {\r\n        blueprint: {\r\n          read: true,\r\n          update: false,\r\n          delete: false\r\n        },\r\n        instance: {\r\n          write: false\r\n        }\r\n      },\r\n      group: {\r\n        blueprint: {\r\n          read: true,\r\n          update: false,\r\n          delete: false\r\n        },\r\n        instance: {\r\n          write: false\r\n        }\r\n      }\r\n    };\r\n\r\n\r\n\r\n  // Resize canvas to avoid bug on elements' size\r\n    function resizeCanvas() {\r\n      var event = document.createEvent('Event');\r\n\r\n      // Define that the event name is 'resize'.\r\n      event.initEvent('resize', true, true);\r\n\r\n      // target can be any Element or other EventTarget.\r\n      window.dispatchEvent(event);\r\n    }\r\n\r\n    $timeout(resizeCanvas);\r\n}]);\r\n\r\n\nangular.module('GMAO Tailor').controller('ElementCtrl', [ '$scope', '$http', '$state', 'Dialog', 'Toast', function($scope, $http, $state, Dialog, Toast) {\n\n  // Code Mirror\n  $scope.editorOptions = {\n    lineNumbers: true,\n    matchBrackets: true,\n    autoCloseBrackets: true,\n    scrollbarStyle: 'simple',\n    readOnly: false,\n    tabSize: 2,\n    smartIndent: true,\n    mode: { name: \"javascript\", typescript: true },\n    theme: 'monokai'\n  };\n\n\n  // Network Related\n\n  function httpElement(method, action, params, versionName) {\n    var config = {\n      method: method,\n      url: '/api/element/' + action\n    };\n\n    config[ (method.toLowerCase() === 'get') ? 'params' : 'data' ] = params || {};\n\n    $http(config)\n      .success(function(element) {\n        element.versions.forEach(function(version) {\n          version.properties.in.forEach(function(inProperty) {\n            if (inProperty.validator === '') {\n              inProperty.validator = defaultProperty.in.validator;\n              inProperty.hasValidator = false;\n            }\n          });\n          version.properties.out.forEach(function(outProperty) {\n            if (outProperty.getter === '') {\n              outProperty.getter = defaultProperty.out.getter;\n              outProperty.hasGetter = false;\n            }\n          });\n        });\n\n        console.log('success httpElement', element);\n\n        $scope.element = element;\n\n        $scope.loadElement(versionName, true);\n      })\n      .error(function(err) {\n        console.log(err);\n        Toast.error(err);\n      });\n  }\n\n  function readElement(id, versionName) {\n    httpElement('GET', 'read', { id: id }, versionName);\n  }\n\n  $scope.loadElement = function(versionName, hideToast) {\n    var version = $scope.element.versions.find(function(version) { return version.name === versionName; }) || $scope.element.versions[$scope.element.versions.length - 1];\n\n    //update url params without reload the state\n    $state.transitionTo('.', { id: $scope.element._id, version: version.name }, { location: true, inherit: true, relative: $state.$current, notify: false });\n\n    $scope.current = {\n      tab: 0,\n      versionName: version.name,\n      versionsName: $scope.element.versions.map(function(version) { return version.name; }),\n      notes: version.notes,\n      todo: version.todo,\n      properties: version.properties,\n      property: angular.copy(defaultProperty)\n    };\n\n    if (!hideToast) Toast.success($scope.element.name + ' (' + version.name + ') has been loaded !');\n  };\n\n  $scope.saveElement = function() {\n    if ($scope.current.properties.in.length + $scope.current.properties.out.length > 0) {\n      var action = (typeof $scope.element._id === 'undefined') ? 'write' : 'update';\n\n      var element = {\n        name: $scope.element.name,\n        description: $scope.element.description,\n        tags: $scope.element.tags,\n        access: $scope.element.access,\n        version: {\n          name: $scope.current.versionName,\n          notes: $scope.current.notes,\n          todo: $scope.current.todo,\n          properties: {\n            in: $scope.current.properties.in.map(function(property) {\n              return {\n                name: property.name,\n                description: property.description,\n                helper: property.helper,\n                type: property.type,\n                required: property.required,\n                multiple: property.multiple,\n                validator: (property.hasValidator) ? property.validator : ''\n              };\n            }),\n            out: $scope.current.properties.out.map(function(property) {\n              return {\n                name: property.name,\n                description: property.description,\n                helper: property.helper,\n                type: property.type,\n                required: property.required,\n                getter: (property.hasGetter) ? property.getter : ''\n              };\n            })\n          }\n        }\n      };\n\n      if (typeof $scope.element._id !== 'undefined') element._id = $scope.element._id;\n\n      console.log('element', element);\n\n      httpElement('POST', action, { element: element }, $scope.current.versionName);\n      Toast.success($scope.element.name + ' has been saved !');\n    } else {\n      Toast.error($scope.element.name + ' has no properties.');\n    }\n  };\n\n  $scope.deleteElement = function(ev) {\n    Dialog\n      .confirmDelete(ev, 'Element')\n      .then(function() { //success : the user decides to crush down his element\n        $http\n          .delete('/api/element/delete', { params: { id: $scope.element._id } })\n          .success(function() {\n            $state.go('elements-private');\n          })\n          .error(function(err) {\n            console.log(err);\n            Toast.error(err);\n          });\n      });\n  };\n\n\n  // Default objects\n\n  var defaultProperty = {\n    in: {\n      name: '',\n      description: '',\n      helper: '',\n      type: [ 'all' ],\n      required: false,\n      multiple: false,\n      hasValidate: false,\n      validator:\n        '\\n/**\\n' +\n        ' *  A Function to test if a connection with this In property and\\n' +\n        ' *  an Out property from another element is valid\\n' +\n        ' *  If valid the connection will be created else it will not\\n' +\n        ' *  and a message explaining the issue will be displayed.\\n' +\n        ' *  \\n' +\n        ' *  Note: A connection can only be made from an In property to an Out property\\n' +\n        '**/\\n\\n' +\n\n        'function(property, outProperty, inProperties) {\\n' +\n        '  // inProperties corresponds to all the others In properties\\n\\n' +\n\n        '  /** property/outProperty or property from inProperties looks like that :\\n' +\n        '   *  {\\n' +\n        '   *     name: String,\\n' +\n        '   *     description: String,\\n' +\n        '   *     helper: String,\\n' +\n        '   *     type: [ String ],\\n' +\n        '   *     required: Bool,\\n' +\n        '   *     \\n' +\n        '   *     // only property has a multiple attribute\\n' +\n        '   *     multiple: Bool,\\n' +\n        '   *     \\n' +\n        '   *     // only outProperty and property from inProperties has a value attribute.\\n' +\n        '   *     // outProperty will carry its value to property if the validation is successful\\n' +\n        '   *     // like every property from inProperties\\n' +\n        '   *     value: anything\\n' +\n        '   * }\\n' +\n        '  **/\\n\\n' +\n\n        '  // return true -> validation successful\\n' +\n        '  // return false -> error with a generic message\\n' +\n        '  // return String -> error with a custom message\\n' +\n        '  return true;\\n' +\n        '}', //function to eval\n      _id: null\n    },\n    out: {\n      name: '',\n      description: '',\n      helper: '',\n      type: [ 'all' ],\n      required: false,\n      hasGetValue: false,\n      getter:\n        '\\n/**\\n' +\n        ' *  A Function to test if a connection with this In property and\\n' +\n        ' *  an Out property from another element is valid\\n' +\n        ' *  If valid the connection will be created else it will not\\n' +\n        ' *  and a message explaining the issue will be displayed.\\n' +\n        ' *  \\n' +\n        ' *  Note: A connection can only be made from an In property to an Out property\\n' +\n        '**/\\n\\n' +\n\n        'function(property, outProperty, inProperties) {\\n' +\n        '  // inProperties corresponds to all the others In properties\\n\\n' +\n\n        '  /** property/outProperty or property from inProperties looks like that :\\n' +\n        '   *  {\\n' +\n        '   *     name: String,\\n' +\n        '   *     description: String,\\n' +\n        '   *     helper: String,\\n' +\n        '   *     type: [ String ],\\n' +\n        '   *     required: Bool,\\n' +\n        '   *     \\n' +\n        '   *     // only property has a multiple attribute\\n' +\n        '   *     multiple: Bool,\\n' +\n        '   *     \\n' +\n        '   *     // only outProperty and property from inProperties has a value attribute.\\n' +\n        '   *     // outProperty will carry its value to property if the validation is successful\\n' +\n        '   *     // like every property from inProperties\\n' +\n        '   *     value: anything\\n' +\n        '   * }\\n' +\n        '  **/\\n\\n' +\n\n        '  // return true -> validation successful\\n' +\n        '  // return false -> error with a generic message\\n' +\n        '  // return String -> error with a custom message\\n' +\n        '  return true;\\n' +\n        '}',\n      _id: null\n    }\n  };\n\n  $scope.element = {\n    name: '',\n    description: '',\n    tags: [],\n    author: {\n      name: $scope.currentUser.name,\n      _id: $scope.currentUser._id\n    },\n    versions: [],\n    access: {\n      public: {\n        element: {\n          read: false,\n          use: false,\n          update: false,\n          delete: false\n        }\n      },\n      users: [],\n      groups: []\n    },\n    userAccess: {\n      element: {\n        read: true,\n        use: true,\n        update: true,\n        delete: true\n      }\n    }\n  };\n\n\n  // Fetch the element if params\n\n  if (typeof $state.params.id !== 'undefined') readElement($state.params.id, $state.params.version);\n\n\n  // Helpers properties\n\n  $scope.types = [\n    'all',\n    'bool',\n    'color',\n    'date',\n    'file',\n    'image',\n    'number',\n    'text'\n  ];\n\n  $scope.search = {\n    text: {\n      properties: {\n        in: '',\n        out: ''\n      }\n    },\n    select: {\n      properties: {\n        in: '$',\n        out: '$'\n      }\n    }\n  };\n\n  $scope.current = {\n    tab : 0,\n    versionName: '0.0.0',\n    versionsName: [],\n    notes: '',\n    todo: '',\n    selected: {\n      in: '',\n      out: ''\n    },\n    text: {\n      in: '',\n      out: ''\n    },\n    properties: {\n      in: [],\n      out: []\n    },\n    property: angular.copy(defaultProperty)\n  };\n\n\n  // Property\n\n  var ids = { //easier to initialize it with a value which will be the max value; -1 -> 0\n    in: [ -1 ],\n    out: [ -1 ]\n  };\n\n  $scope.loadProperty = function(side, property) {\n    $scope.current.property[side] = property;\n    $scope.current.tab = (side === 'in') ? 2 : 4;\n  };\n\n  $scope.removeProperty = function(side, property, index) {\n    if (property._id === $scope.current.property[side]._id) $scope.clearProperty(side);\n\n    delete $scope.current.properties[side][index];\n  };\n\n  $scope.clearProperty = function(side) { // side: 'in' or 'out'\n    $scope.current.property[side] = angular.copy(defaultProperty[side]);\n  };\n\n  $scope.submitProperty = function(side) {\n    var currentProperty = $scope.current.property[side];\n\n    if (currentProperty._id) { //update\n      var foundProperty = $scope.current.properties[side].find(function(property) {\n        return property._id === currentProperty._id;\n      });\n\n      if (typeof foundProperty !== 'undefined') {\n        foundProperty = currentProperty;\n        $scope.current.tab = (side === 'in') ? 1 : 3;\n        $scope.clearProperty(side);\n\n      } else { //err\n        Toast.error('The property cannot be updated : it does not exist anymore. Click another time to add it as a new property');\n        currentProperty._id = null;\n      }\n\n    } else { //add\n      currentProperty._id =  Math.max.apply(null, ids[side]) + 1;\n      ids[side].push(currentProperty._id);\n\n      $scope.current.properties[side].push(currentProperty);\n      $scope.current.tab = (side === 'in') ? 1 : 3;\n      $scope.clearProperty(side);\n    }\n  };\n\n\n  //Access Rights\n  $scope.defaultRights = {\n    user: {\n      element: {\n        read: true,\n        use: true,\n        update: false,\n        delete: false\n      }\n    },\n    group: {\n      element: {\n        read: true,\n        use: false,\n        update: false,\n        delete: false\n      }\n    }\n  };\n\n}]);\n\r\n\nangular.module('GMAO Tailor').controller('GroupCtrl', [ '$scope', '$http', '$state', '$stateParams', 'Dialog', 'Toast', function($scope, $http, $state, $stateParams, Dialog, Toast) {\n\n  //Defines users, from AppCtrl which add them to its scope\n  $scope.defContacts('users');\n\n  $scope.group = {\n    name: '',\n    description: '',\n    visibility: 'private',\n    tags: [],\n    members: [],\n    levels: [],\n    defaultLevel: '',\n    author: {\n      name: $scope.currentUser.name,\n      _id: $scope.currentUser._id\n    }\n  };\n\n  function getLevel(levelId) {\n    return $scope.group.levels.find(function(level) {\n      return level._id === levelId;\n    });\n  }\n\n  function getGroup(id) {\n    $http\n      .get('/api/group/read/' + id)\n      .success(function(data) {\n        $scope.group = data.group;\n\n        $scope.group.members.forEach(function(member) {\n          member.levelName = getLevel(member.level);\n        });\n\n        $scope.userRights = data.userRights;\n      })\n      .error(function(err) {\n        console.log(err);\n        Toast.error(err);\n      });\n  }\n\n\n  //initialization\n  if (typeof $stateParams.id !== 'undefined') {\n    getGroup($stateParams.id);\n  }\n\n\n  $scope.search = {\n    text: {\n      members: '',\n      levels: ''\n    },\n    select: {\n      members: '$',\n      levels: '$'\n    }\n  };\n\n  $scope.current = {\n    tab: 0\n  };\n\n\n  $scope.addMember = {\n    members: [],\n    searchText: '',\n    selectedItem: '',\n    level: {}, //init, it will be an object\n    filter: function(user, index, array) {\n      if (user.name.toLowerCase().indexOf($scope.addMember.searchText.toLowerCase()) > -1 && $scope.group.author._id !== user._id) {\n        return $scope.group.members.every(function(member) {\n          return member.user._id !== user._id;\n        });\n      } else {\n        return false;\n      }\n    },\n    valid: function() {\n      return typeof $scope.addMember.members[0] !== 'undefined' && typeof $scope.addMember.level === 'string';\n    },\n    submit: function() {\n      var level = $scope.group.levels.find(function(level) {\n        return level._id === $scope.addMember.level;\n      });\n\n      var member = {\n        user: {\n          name: $scope.addMember.members[0].name,\n          _id: $scope.addMember.members[0]._id\n        },\n        level: level._id,\n        levelName: level.name\n      };\n      var foundMember = $scope.findMember($scope.addMember.members[0]._id);\n\n\n      if (typeof foundMember !== 'undefined') { //member has to be updated\n        foundMember = member;\n      } else {\n        $scope.group.members.push(member); //member has to be created\n      }\n\n      //reset\n      $scope.addMember.members = [];\n    }\n  };\n\n  $scope.findMember = function(memberId) {\n    return $scope.group.members.find(function(member) {\n      return memberId === member.user._id;\n    });\n  };\n\n  $scope.loadMember = function(member) {\n    $scope.addMember.members[0] = {\n      name: member.user.name,\n      _id: member.user._id\n    };\n\n    $scope.addMember.level = member.level;\n\n    $scope.current.tab = 2;\n  };\n\n  $scope.removeMember = function(member) {\n    $scope.group.members.splice($scope.group.members.indexOf(member), 1);\n  };\n\n\n  $scope.rights = {\n    Informations: [\n      { name: 'Update Informations' }\n    ],\n    Member: [\n      { name: 'See', value: 'Read' },\n      { name: 'Create', value: 'Write' },\n      { name: 'Update' },\n      { name: 'Delete' }\n    ],\n    Level: [\n      { name: 'Create', value: 'Write' },\n      { name: 'Update' },\n      { name: 'Delete' }\n    ],\n    Chat: [\n      { name: 'See', value: 'Read' },\n      { name: 'Respond', value: 'Write' }\n    ],\n    Request: [\n      { name: 'See', value: 'Read' },\n      { name: 'Respond', value: 'Write' }\n    ],\n    Blueprint: [\n      { name: 'See', value: 'Read' },\n      { name: 'Add', value: 'Write' },\n      { name: 'Update' },\n      { name: 'Delete' }\n    ],\n    Instance: [\n      { name: 'See', value: 'Read' },\n      { name: 'Create', value: 'Write' },\n      { name: 'Update' },\n      { name: 'Delete' }\n    ]\n  };\n\n  $scope.rightsSubjects = Object.keys($scope.rights);\n\n  $scope.addLevel = {\n    levelsIds: [ -1 ],\n    level: {\n      name: '',\n      description: '',\n      _id: 0,\n      rights: []\n    },\n    submit: function() {\n      var foundLevel = $scope.group.levels.find(function(level) {\n        return level._id === $scope.addLevel.level._id;\n      });\n\n      if (typeof foundLevel !== 'undefined') { //level exist and has to be updated\n        foundLevel = $scope.addLevel.level;\n\n      } else {\n        //new level\n        var newLevel = {\n          name: $scope.addLevel.level.name,\n          description: $scope.addLevel.level.description,\n          _id: Math.max.apply(null, $scope.addLevel.levelsIds) + 1,\n          rights: $scope.addLevel.level.rights\n        };\n        $scope.group.levels.push(newLevel);\n        $scope.addLevel.levelsIds.push(newLevel._id);\n      }\n\n      //reset\n      $scope.addLevel.level =  {\n        name: '',\n        description: '',\n        _id: Math.max.apply(null, $scope.addLevel.levelsIds) + 1,\n        rights: []\n      };\n    },\n    toggleChecked: function(category, right) {\n      var index = $scope.addLevel.level.rights.indexOf((right.value || right.name) + category);\n      if (index > -1) {\n        $scope.addLevel.level.rights.splice(index, 1);\n      }\n      else {\n        $scope.addLevel.level.rights.push((right.value || right.name) + category);\n      }\n    },\n    isChecked: function(category, right) {\n      return $scope.addLevel.level.rights.indexOf((right.value || right.name) + category) > -1;\n    }\n  };\n\n  $scope.loadLevel = function(level) {\n    $scope.addLevel.level = {\n      name: level.name,\n      description: level.description,\n      _id: level._id,\n      rights: level.rights\n    };\n\n    $scope.current.tab = 4;\n  };\n\n  $scope.removeLevel = function(level) {\n    $scope.group.levels.splice($scope.group.levels.indexOf(level), 1);\n  };\n\n  $scope.setDefaultLevel = function(level) {\n    if ($scope.group.defaultLevel === level._id) {\n      $scope.group.defaultLevel = '';\n    } else {\n      $scope.group.defaultLevel = level._id;\n    }\n  };\n\n\n\n  //directive avatar\n  $scope.url = function() {\n    return (typeof $stateParams.id === 'undefined') ? '/api/group/write' : '/api/group/update';\n  };\n  $scope.defaultSrc = '/avatars/groups/' + ($stateParams.id || 'default');\n\n\n  $scope.groupSubmit = function() {\n    $scope.submitForm($scope.group)\n      .then(function(res) { //success\n        $scope.group = res.group;\n        $scope.userRights = res.userRights;\n\n        //update url params without reload the state\n        $state.transitionTo('.', { id: $scope.group._id }, { location: true, inherit: true, relative: $state.$current, notify: false });\n      });\n  };\n\n  $scope.deleteGroup = function(ev) {\n    Dialog\n      .confirmDelete(ev, 'Group')\n      .then(function() { //success : the user decides to crush down his group\n        $http\n          .delete('/api/group/delete', { params: { id: $scope.group._id} })\n          .success(function() {\n            $state.go('groups');\n          })\n          .error(function(err) {\n            console.log(err);\n            Toast.error(err);\n          });\n      });\n  };\n\n}]);\n\r\n\nangular.module('GMAO Tailor').controller('HomeCtrl', ['$scope', function($scope) {\n\n\n}]);\n\r\n\nangular.module('GMAO Tailor').controller('ObjectsCtrl', [ '$http', '$scope', '$state', 'Toast', function($http, $scope, $state, Toast) {\n\n  $scope.name = $state.current.data.name + 's';\n  $scope.filters = $state.current.data.filters;\n\n  $scope.selectCategory = $state.params.selectCategory || '';\n  $scope.search = {\n    text: {\n      groups: $state.params.searchGroups || ''\n    },\n    select: {\n      groups: $state.params.searchGroupsSelect || '$'\n    }\n  };\n\n  $http\n    .get('/api/' + $scope.name + '/' + $state.current.data.visibility)\n    .success(function(objects) {\n      console.log(objects);\n      $scope.categories = Object.keys(objects);\n      $scope.objects = objects;\n\n      $scope.categories.forEach(function(category) { //to have the search defined for each category\n        $scope.search.text[category] = '';\n        $scope.search.select[category] = $scope.search.select[category] || '$'; //to handle url params\n      });\n    })\n    .error(function(err) {\n      console.log(err);\n      Toast.error(err);\n    });\n\n  $scope.goToObject = function(id) {\n    $state.go($state.current.data.name, { id: id });\n  };\n\n}]);\n\r\n\nangular.module('GMAO Tailor').controller('ProfileCtrl', [ '$scope', 'AuthService', function($scope, AuthService) {\n\n  $scope.profile = {\n    name: $scope.currentUser.name,\n    email: $scope.currentUser.email,\n    oldPassword: '',\n    password: ''\n  };\n\n  //directive avatar\n  $scope.url = '/api/user/update';\n  $scope.defaultSrc = '/avatars/users/' + $scope.currentUser._id;\n\n\n  $scope.clearProfile = function() {\n    $scope.profile = {\n      name: $scope.currentUser.name,\n      email: $scope.currentUser.email,\n      oldPassword: '',\n      password: ''\n    };\n\n    $scope.avatarSrc = $scope.defaultSrc.slice();\n  };\n\n  $scope.submitProfile = function() {\n    $scope.submitForm($scope.profile)\n      .then(function(res) { //success\n        AuthService.updateUser(res);\n      });\n  };\n\n}]);\n\r\n\r\nangular.module('GMAO Tailor').directive('accessRights', function() {\r\n\r\n  return {\r\n    restrict: 'E',\r\n    replace: true,\r\n    scope: {\r\n      'access': '=',\r\n      'defaultRights': '=',\r\n      'author': '='\r\n    },\r\n    templateUrl: '/templates/directives/accessRights.html',\r\n    controller: [ '$scope', function($scope) {\r\n\r\n      $scope.models = [];\r\n      angular.forEach($scope.defaultRights.user, function(value, key) {\r\n        $scope.models.push({ name: key, rights: Object.keys(value) });\r\n      });\r\n\r\n      $scope.rightsIcons = {\r\n        read: 'fa-eye',\r\n        use: 'fa-hand-grab-o',\r\n        update: 'fa-pencil',\r\n        delete: 'fa-trash-o'\r\n      };\r\n\r\n      $scope.checked = true;\r\n\r\n\r\n      //Constructor\r\n      function Handler(contact) { //concat : 'user' || 'group'\r\n        var _this = this;\r\n\r\n        var contacts = contact + 's';\r\n        this[contact] = {}; //this.user || this.group\r\n        this[contacts] = []; //this.users || this.groups\r\n\r\n        angular.merge(this, {\r\n          avatar: null,\r\n          searchText: '',\r\n          selectedItem: '',\r\n          filter: function(contact, index, array) {\r\n            if (contact.name.toLowerCase().indexOf(_this.searchText.toLowerCase()) > -1 && author._id !== contact._id) {\r\n              return $scope.access[contacts].every(function(accessContact) {\r\n                return accessContact[contact]._id !== contact._id;\r\n              });\r\n            }\r\n          },\r\n          load: function() {\r\n            _this[contact] = {\r\n              contact: {\r\n                name: _this[contacts][0].name,\r\n                _id: _this[contacts][0]._id\r\n              },\r\n              access: $scope.defaultRights[contact].slice()\r\n            };\r\n\r\n            _this.avatar = _this[contact][contact]._id;\r\n          },\r\n          clear: function() {\r\n            _this[contact] = {};\r\n            _this[contacts] = [];\r\n            _this.avatar = null;\r\n          },\r\n          addUser: function() {\r\n            $scope.access[contacts].push(_this[contact]);\r\n            _this.clear();\r\n          },\r\n          removeUser: function(contact) {\r\n            $scope.access[contacts].splice($scope.access[contacts].indexOf(contact), 1);\r\n          }\r\n        });\r\n\r\n      }\r\n\r\n\r\n      //Fetch users and groups for access rights (private) from AppCtrl which add them to its scope\r\n      $scope.defContacts('users');\r\n      $scope.defContacts('groups');\r\n\r\n      $scope.usersAccess = new Handler('user');\r\n      $scope.groupsAccess = new Handler('group');\r\n\r\n    }]\r\n  };\r\n});\r\n\r\nangular.module('GMAO Tailor').directive('avatar', function() {\r\n  return {\r\n    restrict: 'E',\r\n    replace: true,\r\n    scope: false,\r\n    template:\r\n      '<div class=\"avatar-container\">' +\r\n        '<img ng-src=\"{{avatarSrc}}\" />' +\r\n        '<md-button class=\"avatar-button md-error\" ng-show=\"avatarSrc !== defaultSrc\" ng-click=\"restoreAvatar()\">' +\r\n          '<i class=\"fa fa-refresh\" aria-hidden=\"true\"></i>' +\r\n          '<span>Avatar</span>' +\r\n        '</md-button>' +\r\n        '<div ng-show=\"avatarSrc === defaultSrc\">' +\r\n          '<input id=\"input-avatar\" type=\"file\" accept=\"image/*\">' +\r\n          '<label for=\"input-avatar\" class=\"avatar-button md-button md-raised md-primary\">' +\r\n            '<i class=\"fa fa-upload\" aria-hidden=\"true\"></i>' +\r\n            '<span>Avatar</span>' +\r\n          '</label>' +\r\n        '</div>' +\r\n      '</div>',\r\n    controller: [ '$scope', '$q', '$http', 'Toast', function($scope, $q, $http, Toast) {\r\n\r\n      $scope.restoreAvatar = function() {\r\n        $scope.avatarSrc = $scope.defaultSrc.slice();\r\n      };\r\n\r\n      var inputAvatar =  document.getElementById('input-avatar');\r\n      $scope.restoreAvatar(); //init\r\n\r\n      // scales the image by (float) scale < 1\r\n      // returns a canvas containing the scaled image.\r\n      function downScaleImage(img, size) {\r\n          var imgCV = document.createElement('canvas');\r\n          imgCV.width = img.width;\r\n          imgCV.height = img.height;\r\n          var imgCtx = imgCV.getContext('2d');\r\n          imgCtx.drawImage(img, 0, 0);\r\n          return downScaleCanvas(imgCV, size);\r\n      }\r\n\r\n      // scales the canvas by (float) scale < 1\r\n      // returns a new canvas containing the scaled image.\r\n      function downScaleCanvas(cv, size) {\r\n          var xScale = size / cv.width;\r\n          var yScale = size / cv.height;\r\n          var sqScale = xScale * yScale; // square scale = area of source pixel within target\r\n          var sw = cv.width; // source image width\r\n          var sh = cv.height; // source image height\r\n          var tw = size; // target image width\r\n          var th = size; // target image height\r\n          var sx = 0, sy = 0, sIndex = 0; // source x,y, index within source array\r\n          var tx = 0, ty = 0, yIndex = 0, tIndex = 0; // target x,y, x,y index within target array\r\n          var tX = 0, tY = 0; // rounded tx, ty\r\n          var w = 0, nw = 0, wx = 0, nwx = 0, wy = 0, nwy = 0; // weight / next weight x / y\r\n          // weight is weight of current source point within target.\r\n          // next weight is weight of current source point within next target's point.\r\n          var crossX = false; // does scaled px cross its current px right border ?\r\n          var crossY = false; // does scaled px cross its current px bottom border ?\r\n          var sBuffer = cv.getContext('2d').\r\n          getImageData(0, 0, sw, sh).data; // source buffer 8 bit rgba\r\n          var tBuffer = new Float32Array(3 * tw * th); // target buffer Float32 rgb\r\n          var sR = 0, sG = 0,  sB = 0; // source's current point r,g,b\r\n          /* untested !\r\n          var sA = 0;  //source alpha  */\r\n\r\n          for (sy = 0; sy < sh; sy++) {\r\n              ty = sy * yScale; // y src position within target\r\n              tY = 0 | ty;     // rounded : target pixel's y\r\n              yIndex = 3 * tY * tw;  // line index within target array\r\n              crossY = (tY != (0 | ty + yScale));\r\n              if (crossY) { // if pixel is crossing bottom target pixel\r\n                  wy = (tY + 1 - ty); // weight of point within target pixel\r\n                  nwy = (ty + yScale - tY - 1); // ... within y+1 target pixel\r\n              }\r\n              for (sx = 0; sx < sw; sx++, sIndex += 4) {\r\n                  tx = sx * xScale; // x src position within target\r\n                  tX = 0 | tx;    // rounded : target pixel's x\r\n                  tIndex = yIndex + tX * 3; // target pixel index within target array\r\n                  crossX = (tX != (0 | tx + xScale));\r\n                  if (crossX) { // if pixel is crossing target pixel's right\r\n                      wx = (tX + 1 - tx); // weight of point within target pixel\r\n                      nwx = (tx + xScale - tX - 1); // ... within x+1 target pixel\r\n                  }\r\n                  sR = sBuffer[sIndex    ];   // retrieving r,g,b for curr src px.\r\n                  sG = sBuffer[sIndex + 1];\r\n                  sB = sBuffer[sIndex + 2];\r\n\r\n                  /* !! untested : handling alpha !!\r\n                     sA = sBuffer[sIndex + 3];\r\n                     if (!sA) continue;\r\n                     if (sA != 0xFF) {\r\n                         sR = (sR * sA) >> 8;  // or use /256 instead ??\r\n                         sG = (sG * sA) >> 8;\r\n                         sB = (sB * sA) >> 8;\r\n                     }\r\n                  */\r\n                  if (!crossX && !crossY) { // pixel does not cross\r\n                      // just add components weighted by squared scale.\r\n                      tBuffer[tIndex    ] += sR * sqScale;\r\n                      tBuffer[tIndex + 1] += sG * sqScale;\r\n                      tBuffer[tIndex + 2] += sB * sqScale;\r\n                  } else if (crossX && !crossY) { // cross on X only\r\n                      w = wx * yScale;\r\n                      // add weighted component for current px\r\n                      tBuffer[tIndex    ] += sR * w;\r\n                      tBuffer[tIndex + 1] += sG * w;\r\n                      tBuffer[tIndex + 2] += sB * w;\r\n                      // add weighted component for next (tX+1) px\r\n                      nw = nwx * yScale;\r\n                      tBuffer[tIndex + 3] += sR * nw;\r\n                      tBuffer[tIndex + 4] += sG * nw;\r\n                      tBuffer[tIndex + 5] += sB * nw;\r\n                  } else if (crossY && !crossX) { // cross on Y only\r\n                      w = wy * xScale;\r\n                      // add weighted component for current px\r\n                      tBuffer[tIndex    ] += sR * w;\r\n                      tBuffer[tIndex + 1] += sG * w;\r\n                      tBuffer[tIndex + 2] += sB * w;\r\n                      // add weighted component for next (tY+1) px\r\n                      nw = nwy * xScale;\r\n                      tBuffer[tIndex + 3 * tw    ] += sR * nw;\r\n                      tBuffer[tIndex + 3 * tw + 1] += sG * nw;\r\n                      tBuffer[tIndex + 3 * tw + 2] += sB * nw;\r\n                  } else { // crosses both x and y : four target points involved\r\n                      // add weighted component for current px\r\n                      w = wx * wy;\r\n                      tBuffer[tIndex    ] += sR * w;\r\n                      tBuffer[tIndex + 1] += sG * w;\r\n                      tBuffer[tIndex + 2] += sB * w;\r\n                      // for tX + 1; tY px\r\n                      nw = nwx * wy;\r\n                      tBuffer[tIndex + 3] += sR * nw;\r\n                      tBuffer[tIndex + 4] += sG * nw;\r\n                      tBuffer[tIndex + 5] += sB * nw;\r\n                      // for tX ; tY + 1 px\r\n                      nw = wx * nwy;\r\n                      tBuffer[tIndex + 3 * tw    ] += sR * nw;\r\n                      tBuffer[tIndex + 3 * tw + 1] += sG * nw;\r\n                      tBuffer[tIndex + 3 * tw + 2] += sB * nw;\r\n                      // for tX + 1 ; tY +1 px\r\n                      nw = nwx * nwy;\r\n                      tBuffer[tIndex + 3 * tw + 3] += sR * nw;\r\n                      tBuffer[tIndex + 3 * tw + 4] += sG * nw;\r\n                      tBuffer[tIndex + 3 * tw + 5] += sB * nw;\r\n                  }\r\n              } // end for sx\r\n          } // end for sy\r\n\r\n          // create result canvas\r\n          var resCV = document.createElement('canvas');\r\n          resCV.width = tw;\r\n          resCV.height = th;\r\n          var resCtx = resCV.getContext('2d');\r\n          var imgRes = resCtx.getImageData(0, 0, tw, th);\r\n          var tByteBuffer = imgRes.data;\r\n          // convert float32 array into a UInt8Clamped Array\r\n          var pxIndex = 0; //\r\n          for (sIndex = 0, tIndex = 0; pxIndex < tw * th; sIndex += 3, tIndex += 4, pxIndex++) {\r\n              tByteBuffer[tIndex] = Math.ceil(tBuffer[sIndex]);\r\n              tByteBuffer[tIndex + 1] = Math.ceil(tBuffer[sIndex + 1]);\r\n              tByteBuffer[tIndex + 2] = Math.ceil(tBuffer[sIndex + 2]);\r\n              tByteBuffer[tIndex + 3] = 255;\r\n          }\r\n          // writing result to canvas.\r\n          resCtx.putImageData(imgRes, 0, 0);\r\n          return resCV;\r\n      }\r\n\r\n      var reader = new FileReader();\r\n      reader.onload = function (event) {\r\n        var image = new Image();\r\n        image.src = event.target.result;\r\n\r\n        image.onload = function() {\r\n          var canvas = downScaleImage(image, 128);\r\n          var dataUrl = canvas.toDataURL(inputAvatar.files[0].type);\r\n\r\n          $scope.avatarSrc = dataUrl; //display the new avatar\r\n          delete inputAvatar.files[0];\r\n\r\n          $scope.$apply();\r\n        };\r\n      };\r\n\r\n      inputAvatar.onchange = function() {\r\n        var newAvatar = inputAvatar.files[0];\r\n        if (typeof newAvatar !== 'undefined') {\r\n          if (newAvatar.type.indexOf('image') === 0) { //the type start by 'image/*'\r\n            reader.readAsDataURL(newAvatar); //trigger reader.onload() and resize the avatar to $scope.avatarSrc\r\n          } else {\r\n            delete inputAvatar.files[0];\r\n            Toast.error('An image is expected.');\r\n          }\r\n        }\r\n      };\r\n\r\n      $scope.submitForm = function(params) {\r\n        return $q(function(resolve, reject) {\r\n           var url = (typeof $scope.url === 'function') ? $scope.url() : $scope.url;\r\n           if ($scope.avatarSrc !== $scope.defaultSrc) params.avatar = $scope.avatarSrc;\r\n\r\n            $http\r\n              .post(url, params)\r\n              .success(function(res) {\r\n                Toast.success('Saved !');\r\n                $scope.restoreAvatar(); //now the new avatar is the default\r\n\r\n                return resolve(res);\r\n              })\r\n              .error(function(err) {\r\n                console.log(err);\r\n                Toast.error(err);\r\n\r\n                return reject(err);\r\n              });\r\n\r\n        });\r\n      };\r\n\r\n\r\n    }]\r\n  };\r\n});\r\n\r\n\r\nangular.module('GMAO Tailor').directive('codeMirror', function() {\r\n  return {\r\n    restrict: 'A',\r\n    scope:  {\r\n      options: '=',\r\n      val: '='\r\n    },\r\n    link: function(scope, elements, attrs) {\r\n      var myCodeMirror = CodeMirror.fromTextArea(elements[0], scope.options);\r\n\r\n      myCodeMirror.setValue(scope.val);\r\n\r\n      scope.$watch('val', function(newValue, oldValue, scope) {\r\n        myCodeMirror.setValue(newValue);\r\n      });\r\n\r\n      scope.$watch('options.theme', function(newValue, oldValue, scope) {\r\n        myCodeMirror.setOption('theme', newValue);\r\n      });\r\n    }\r\n  };\r\n});\r\n\r\n\r\nangular.module('GMAO Tailor').directive('contextMenu', [ function() {\r\n\r\n\r\n  return {\r\n    restrict: 'E',\r\n    replace: true,\r\n    transclude: true,\r\n    templateUrl: '/templates/directives/contextMenu.html',\r\n    require: 'mdMenu',\r\n    link: function(scope, element, attrs, mdMenuCtrl) {\r\n      scope.openContextMenu = function(event) {\r\n        mdMenuCtrl.offsets = function() {\r\n          return { left: event.offsetX, top: event.offsetY };\r\n        };\r\n        mdMenuCtrl.open($event);\r\n      };\r\n    },\r\n    controller: [ '$scope', '$http', 'Definition', 'Element', function($scope, $http, Definition, Element) {\r\n      $scope.lists = [];\r\n\r\n      $http\r\n        .get('/api/contextmenu')\r\n        .success(function(data) {\r\n          $scope.lists = data.lists;// { name: String, description: String, elements: [ { version, definition: { name, _id } } ] }\r\n          Definition.import(data.definitions);\r\n        });\r\n\r\n      $scope.createElement = function(definitionId, versionName) {\r\n        new Element({ definition: definitionId, version: versionName });\r\n      };\r\n    }]\r\n  };\r\n\r\n}]);\r\n\r\n/**\r\n * @name ng-scrollbar\r\n * @author angrytoro\r\n * @since 9/12/2014\r\n * @version 0.1\r\n * @beta 0.2\r\n * @see https://github.com/angrytoro/ngscrollbar\r\n * @copyright 2014 angrytoro\r\n * @license MIT: You are free to use and modify this code, on the condition that this copyright notice remains.\r\n *\r\n * @description The angular directive ng-scrollbar imitate the true browser scrollbar.\r\n * It's applied to the element which set height or width attribute and the overflow is auto, but exclude body element.\r\n * It's not necessary to imitate scrollbar for body element, if you use the AngularJS.\r\n * suggests: don't use the directive, if you don't have to. The scrollbar which is inbuilt in browser is more highly-efficient.\r\n * AngularJS is not fit for IE which version is less then 9, so the directive is not fit the IE(8,7,6,5).\r\n *\r\n *\r\n * @example\r\n * <div ng-scroll scrollbar-x=\"false\" scrollbar-y=\"true\" scroll-config=\"{ overlay: true, autoResize: true, size: 'small', dragSpeed: 1.2 }\">\r\n *     <div>Any Content</div>\r\n * </div>\r\n *\r\n * @conf spec\r\n * scrollbar-x the value is true or false, to configure the x scrollbar create or no create, the default value is true. but the directive can decide whether it need be created if user not set the attribute.\r\n *\r\n * scrollbar-y the value is true or false, to configure the y scrollbar create or no create, the default value is true. but the directive can decide whether it need be created if user not set the attribute.\r\n *\r\n * scroll-config\r\n * default config is\r\n *\r\n * {\r\n *      dragSpeed: 1, //default browser delta value is 120 or -120\r\n        autoResize: false, // if need auto resize, default false\r\n        overlay: false, // if need show when mouse not enter the container element which need scrollbar, default false.\r\n        size: 'small' //enum : 'small', 'medium', 'large'\r\n * }\r\n *\r\n */\r\n\r\nangular.module('GMAO Tailor').directive('ngScroll', [\r\n    function() {\r\n        return {\r\n            restrict: 'AE',\r\n            transclude: true,\r\n            scope: {\r\n                scrollConfig: '=',\r\n                scrollbarX: '@', // the value is true or false, to configure the x scrollbar create or no create.\r\n                scrollbarY: '@' // the value is true or false, to configure the y scrollbar create or no create.\r\n            },\r\n            template: '<div class=\"ngscroll\" ng-class=\"{ \\'ngscroll-overlay\\': config.overlay, \\'small\\': config.size === \\'small\\', \\'medium\\': config.size === \\'medium\\', \\'large\\': config.size === \\'large\\' }\">' +\r\n                            '<div class=\"ngscroll-content-container\" ng-transclude>' +\r\n                            '</div>' +\r\n                            '<ng-scrollbar scrollbar-axis=\"x\" ng-if=\"scrollbarX || scrollbarX === undefined\"></ng-scrollbar>' +\r\n                            '<ng-scrollbar scrollbar-axis=\"y\" ng-if=\"scrollbarY || scrollbarY === undefined\"></ng-scrollbar>' +\r\n                            '<div class=\"ng-scrollbar-filler\" ng-hide=\"(scrollbarX || scrollbarX === undefined) && (scrollbarY || scrollbarY === undefined)\"></div>' +\r\n                       '</div>',\r\n            controller: function() {\r\n                //nothing to do\r\n            },\r\n            compile: function(element) {\r\n                element.css('overflow', 'hidden');\r\n                return function(scope, element, attrs, ctrl) {\r\n\r\n                    var defaultConfig = {\r\n                        dragSpeed: 1, //default browser delta value is 120 or -120\r\n                        autoResize: false, // if need auto resize, default false\r\n                        overlay: false, // if need show when mouse not enter the container element which need scrollbar, default false.\r\n                        size: 'small'\r\n                    };\r\n\r\n                    ctrl.config = angular.copy(angular.extend(defaultConfig, scope.scrollConfig || {}));\r\n                    scope.config = ctrl.config;\r\n\r\n                    scope.$watch('scrollConfig', function(newValue, oldValue, scope) {\r\n                        ctrl.config = angular.extend(defaultConfig, newValue || {});\r\n                        scope.config = ctrl.config;\r\n                    });\r\n\r\n                    ctrl.containerElement = element;\r\n                    ctrl.contentElement = angular.element(element[0].querySelector('.ngscroll-content-container'));\r\n                };\r\n            }\r\n        };\r\n    }\r\n])\r\n.directive('ngScrollbar', [ '$timeout', function($timeout) {\r\n    return {\r\n        restrict: 'AE',\r\n        replace: true,\r\n        require: '^?ngScroll',\r\n        scope: {\r\n          'scrollbarAxis': '@'\r\n        },\r\n        template: '<div class=\"ngscrollbar-container ngscrollbar-container-{{scrollbarAxis}}\"><div class=\"ngscrollbar\"></div></div>',\r\n        compile: function() {\r\n            return function(scope, element, attrs, ctrl) {\r\n\r\n                var docEl = angular.element(document),\r\n                    side = (scope.scrollbarAxis === 'x') ? { name: 'width', offsetName: 'offsetWidth', screenAxis: 'screenX', direction: 'left', margin: 'margin-left' } : { name: 'height', offsetName: 'offsetHeight', screenAxis: 'screenY', direction: 'top', margin: 'margin-top' },\r\n                    scrollbar = angular.element(element[0].querySelector('.ngscrollbar'));\n\n                function getContentOffset() {\r\n                    //console.log('getContentOffset', ctrl.contentElement[0][side.offsetName]);\r\n                    return ctrl.contentElement[0][side.offsetName];\r\n                }\n\n                function getContainerOffset() {\n                    //console.log('getContainerOffset', ctrl.containerElement[0][side.offsetName]);\n                    return ctrl.containerElement[0][side.offsetName];\n                }\r\n\r\n\r\n                function reset() {\r\n                    var oldMargin = parseInt(ctrl.contentElement.css(side.margin), 10);\r\n                    ctrl.contentElement.css(side.margin, '0px');\r\n                    if (getContentOffset() > getContainerOffset()) { //if is overflow\r\n                        element.css('display', 'block');\r\n                        scrollbar.css(side.name, Math.pow(getContainerOffset(), 2) / getContentOffset() + 'px'); //scrollbar offset\r\n                        scrollTo(oldMargin);\r\n                    } else {\r\n                        element.css('display', 'none');\r\n                    }\r\n                }\r\n\r\n                function scrollTo(offset) {\r\n                    offset = Math.min(0, Math.max(offset, getContainerOffset() - getContentOffset()));\r\n                    ctrl.contentElement.css(side.margin, offset + 'px');\r\n                    scrollbar.css(side.direction, -offset / getContentOffset() * getContainerOffset() + 'px');\r\n                }\r\n\r\n                function scroll(distance) {\r\n                    var offset = parseInt(ctrl.contentElement.css(side.margin), 10) + distance;\r\n                    scrollTo(offset);\r\n                }\r\n\r\n\r\n                var offset,\r\n                    scrollbarMousedown = false;\r\n\r\n                scrollbar.on('mousedown', function(event) {\r\n                    event.preventDefault();\r\n                    scrollbarMousedown = true;\r\n                    offset = event[side.screenAxis];\r\n                    docEl.one('mouseup', function() {\r\n                        scrollbarMousedown = false;\r\n                    });\r\n                });\n\r\n                docEl.on('mousemove', function(event) {\r\n                    if (scrollbarMousedown) {\r\n                        event.preventDefault();\r\n                        scroll(-(event[side.screenAxis] - offset) * ctrl.config.dragSpeed * getContentOffset() / getContainerOffset());\r\n                        offset = event[side.screenAxis];\r\n                    }\r\n                });\r\n\r\n                $timeout(function() {\r\n                    reset();\r\n                    if (!!document.createStyleSheet) { //if the browser is ie browser\r\n                        ctrl.contentElement.on('DOMNodeInserted', reset);\r\n                        ctrl.contentElement.on('DOMNodeRemoved', reset);\r\n                    } else {\r\n                        var observer = new MutationObserver(function(mutations) {\r\n                            if (mutations.length) {\r\n                                reset();\r\n                            }\r\n                        });\r\n                        observer.observe(ctrl.contentElement[0], { childList: true, subtree: true });\r\n                    }\r\n                }, 5);\r\n\r\n                // Redraw the scrollbar when window size changes.\r\n                if (ctrl.config.autoResize) {\r\n                    // Closure to guard against leaking variables.\r\n                    (function() {\r\n                        var redrawTimer;\r\n\r\n                        angular.element(window).on('resize', function(e) {\r\n                            if (redrawTimer) {\r\n                                clearTimeout(redrawTimer);\r\n                            }\r\n                            redrawTimer = setTimeout(function() {\r\n                                redrawTimer = null;\r\n                                reset();\r\n                            }, 50);\r\n                        });\r\n                    })();\r\n                }\r\n\r\n\r\n                /* Only for the vertical scrollbar */\r\n                if (scope.scrollbarAxis === 'y') {\r\n                    ctrl.containerElement.on('mousewheel', function(event) {\r\n                        if (getContentOffset() <= getContainerOffset()) { //if is not overflow\r\n                            return;\r\n                        }\r\n                        event.preventDefault();\r\n                        if (event.originalEvent !== undefined) {\r\n                            event = event.originalEvent;\r\n                        }\r\n                        scroll(event.wheelDeltaY || event.wheelDelta);\r\n                    });\r\n\r\n                    if (window.navigator.userAgent.toLowerCase().indexOf('firefox') >= 0) {\r\n                        ctrl.containerElement.on('wheel', function(event) {\r\n                            if (getContentOffset() <= getContainerOffset()) { //if is not overflow\r\n                                return;\r\n                            }\r\n                            event.preventDefault();\r\n                            if (event.originalEvent !== undefined) {\r\n                                event = event.originalEvent;\r\n                            }\r\n                            scroll(-event.deltaY * 40);// the ff delta value is 3 or -3 when scroll and the chrome or ie is -120 or 120, so it must multiply by 40\r\n                        });\r\n                    }\r\n                }\r\n\r\n            };\r\n        }\r\n    };\r\n}]);\r\n\r\nangular.module('GMAO Tailor').factory('AuthService', [ '$window', '$rootScope', '$http', 'AUTH_EVENTS', 'Session', function($window, $rootScope, $http, AUTH_EVENTS, Session) {\r\n\r\n  return {\r\n\r\n    currentUser: function(cb) { //with a callback if asynchrone\r\n      return $http\r\n        .get('/api/auth/user')\r\n        .success(function(user) {\r\n          console.log(user);\r\n          Session.create(user.id, user.role);\r\n          $rootScope.$broadcast(AUTH_EVENTS.loginSuccess, user);\r\n          if (typeof cb !== 'undefined') return cb(null, user);\r\n          return user;\r\n        })\r\n        .error(function(err) {\r\n          console.log('err', err);\r\n          //Erase the token if the user fails to log in\r\n          delete $window.localStorage.token;\r\n          $rootScope.$broadcast(AUTH_EVENTS.loginFailed, err);\r\n          if (typeof cb !== 'undefined') return cb(err);\r\n          return err;\r\n        });\r\n    },\r\n\r\n    login: function(credentials, cb) { //with a callback if asynchrone\r\n      return $http\r\n        .post('/auth/login', credentials)\r\n        .success(function(res) {\r\n          console.log(res.user);\r\n          $window.localStorage.token = res.token;\r\n          Session.create(res.user.id, res.user.role);\r\n          $rootScope.$broadcast(AUTH_EVENTS.loginSuccess, res.user);\r\n          if (typeof cb !== 'undefined') return cb(null, res.user);\r\n          return res.user;\r\n        })\r\n        .error(function(err) {\r\n          $rootScope.$broadcast(AUTH_EVENTS.loginFailed, err);\r\n          if (typeof cb !== 'undefined') return cb(err);\r\n          return err;\r\n        });\r\n    },\r\n\r\n    register: function(credentials, cb) { //with a callback if asynchrone\r\n      return $http\r\n        .post('/auth/register', credentials)\r\n        .success(function(res) {\r\n          console.log(res.user);\r\n          $window.localStorage.token = res.token;\r\n          Session.create(res.user.id, res.user.role);\r\n          $rootScope.$broadcast(AUTH_EVENTS.registerSuccess, res.user);\r\n          if (typeof cb !== 'undefined') return cb(null, res.user);\r\n          return res.user;\r\n        })\r\n        .error(function(err) {\r\n          $rootScope.$broadcast(AUTH_EVENTS.registerFailed, err);\r\n          if (typeof cb !== 'undefined') return cb(err);\r\n          return err;\r\n        });\r\n    },\r\n\r\n    updateUser: function(res, cb) {\r\n      console.log(res.user);\r\n      $window.localStorage.token = res.token;\r\n      Session.create(res.user.id, res.user.role);\r\n      $rootScope.$broadcast(AUTH_EVENTS.updateUserSuccess, res.user);\r\n      if (typeof cb !== 'undefined') return cb(null, res.user);\r\n      return res.user;\r\n    },\r\n\r\n    logout: function() {\r\n      $http\r\n        .post('/api/auth/logout')\r\n        .success(function() {\r\n          console.log('logout succeeded');\r\n          delete $window.localStorage.token;\r\n          window.location = '/home';\r\n        })\r\n        .error(function(err) {\r\n          console.log('logout failed', err);\r\n        });\r\n    },\r\n\r\n    isAuthenticated: function() {\r\n      return Session.userId !== null;\r\n    },\r\n\r\n    isAuthorized: function(authorizedRoles) {\r\n      if (!angular.isArray(authorizedRoles)) authorizedRoles = [authorizedRoles];\r\n\r\n      return (this.isAuthenticated() && authorizedRoles.indexOf(Session.userRole) !== -1);\r\n    }\r\n\r\n  };\r\n\r\n}]);\r\n\r\nangular.module('GMAO Tailor').service('Dialog', [ '$mdDialog', '$mdMedia', function($mdDialog, $mdMedia) {\r\n\r\n  this.confirmDelete = function(ev, name) {\r\n    return $mdDialog.show({\r\n      controller: 'ConfirmDeleteDialogCtrl',\r\n      templateUrl: '/templates/components/confirmDeleteDialog.html',\r\n      parent: angular.element(document.body),\r\n      targetEvent: ev,\r\n      clickOutsideToClose:true,\r\n      fullscreen: $mdMedia('sm')\r\n    });\r\n  };\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').service('Session', function() {\r\n\r\n        //init\r\n        this.userId = null;\r\n        this.userRole = null;\r\n\r\n        //functions\r\n        this.create = function(userId, userRole) {\r\n          this.userId = userId;\r\n          this.userRole = userRole;\r\n        };\r\n\r\n        this.destroy = function() {\r\n          this.userId = null;\r\n          this.userRole = null;\r\n        };\r\n\r\n});\r\n\r\nangular.module('GMAO Tailor').factory('Settings', [ function() {\n\n  return {\n\n    Connector: {\n      styles: {\n        external: {\n          default: {\n            fillColor: 'rgba(255,255,255,0)',\n            strokeColor: '#222222'\n          },\n          multiple: {\n            fillColor: 'rgba(255,255,255,0)',\n            strokeColor: '#c057eb'\n          }\n        },\n        internal: {\n          available: {\n            fillColor: '#5ad97d'\n          }\n        }\n      },\n      hover: {\n        scale: 1.2\n      },\n      rotating: {\n        spin: 4\n      }\n    },\n\n    property: {\n\n    },\n\n    view: {\n      zoom : {\n        value: 0.85,\n        pitch: 0.1\n      }\n    },\n\n    keybindings: { //[ keybindings ] === [ [key] ]\n      toggleSelectAll: [  [ 'control', 'A' ]  ],\n      inverseSelection: [ [ 'Shift', 'A' ] ],\n      copySelected: [  [ 'control', 'C' ]  ],\n      pasteCopied: [  [ 'control', 'V' ]  ],\n      moveView: [], //no need to press a key\n      select: [  [ 'control' ]  ],\n      deselect: [  [ 'shift' ]  ],\n      restoreZoom: [  [ 'tab' ]  ],\n      plusZoom: [  [ '+' ]  ],\n      minusZoom: [  [ '-' ]  ],\n      center: [  [ 'space' ]  ], //view or selected\n      centerView: [  [ 'control', 'space' ], [ 'enter' ]  ],\n      deleteSelected: [  [ 'delete' ]  ],\n      restoreInterface: [  [ 'escape' ]  ], //abort selection/deselection, deselect all, center on view, restore zoom, close context menu, ...\n      moveUp: [  [ 'up' ]  ],\n      moveDown: [  [ 'down' ]  ],\n      moveLeft: [  [ 'left' ]  ],\n      moveRight: [  [ 'right' ]  ]\n    },\n\n    Global: {\n      selection: {\n        strokeColor: '#447DF4',\n        strokeWidth: 2,\n        fillColor: 'rgba(68, 125, 244, 0.7)'\n      },\n\n      deselection: {\n        strokeColor: '#447DF4',\n        strokeWidth: 2,\n        fillColor: 'rgba(250, 250, 250, 0.1)'\n      }\n    },\n\n    ContextMenu: {\n      offset: {\n        x: 15,\n        y: 15\n      }\n    },\n\n    Element: {\n      default: {\n        main: {\n          background: {\n            fillColor: '#fff'\n          },\n          property: {\n            fontFamily: 'Calibri',\n            fontWeight: 'normal',\n            fontSize: 20\n          }\n        },\n        header: {\n          background: {\n            fillColor: '#78CE88'\n          },\n          text: {\n            fillColor: '#fff',\n            fontFamily: 'Calibri',\n            fontWeight: 'normal',\n            fontSize: 20\n          }\n        }\n      },\n      selected: {\n        main: {\n          background: {\n            fillColor: 'rgba(255, 255, 255, .65)'\n          }\n        },\n        header: {\n          background: {\n            fillColor: 'rgba(121 ,207, 137, .65)'\n          }\n        }\n      },\n      required: {\n        main: {\n          property: {\n            fontWeight: 'italic bold'\n          }\n        }\n      }\n    }\n\n  };\n\n}]);\n\r\n\r\nangular.module('GMAO Tailor').service('Socket', [ '$window', 'Toast', function($window, Toast) {\r\n\r\n        //init\r\n        var _this = this;\r\n\r\n        this.socket = null;\r\n        this.authenticated = false;\r\n        var onAuthentification = []; //several functions to call when socket.on('authentication')\r\n\r\n        //functions\r\n        this.connect = function() {\r\n          _this.socket = io();\r\n\r\n          _this.socket.on('error', function(err) {\r\n            console.log(err);\r\n            Toast.error(err.message || err);\r\n          });\r\n\r\n          _this.socket.on('connect', function() {\r\n            _this.socket.emit('authentication', $window.localStorage.token);\r\n\r\n            _this.socket.on('authenticated', function(data) {\r\n              _this.authenticated = true;\r\n\r\n              onAuthentification.forEach(function(eventHandler) {\r\n                eventHandler(_this.socket, data);\r\n              });\r\n            });\r\n          });\r\n        };\r\n\r\n        this.disconnect = function() {\r\n          if (_this.authenticated) {\r\n            _this.socket.disconnect();\r\n          }\r\n        };\r\n\r\n        this.onAuthentification = function(eventHandler) {\r\n          onAuthentification.push(eventHandler);\r\n        };\r\n\r\n}]);\r\n\r\nangular.module('GMAO Tailor').service('Toast', [ '$mdToast', function($mdToast) {\r\n\r\n  function createToast(msg, cssClass) {\r\n    cssClass = (cssClass) ? ' ' + cssClass : '';\r\n    $mdToast.show({\r\n      template: '<md-toast class=\"md-toast' + cssClass + '\">' + msg + '</md-toast>',\r\n      hideDelay: 3000,\r\n      position: 'bottom left'\r\n    });\r\n  }\r\n\r\n  this.default = function(msg) {\r\n    createToast(msg);\r\n  };\r\n\r\n  this.error = function(msg) {\r\n    createToast(msg, 'md-error');\r\n  };\r\n\r\n  this.success = function(msg) {\r\n    createToast(msg, 'md-success');\r\n  };\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').service('AllInstances', [ function() {\r\n\r\n  this.newCollection = function(key) {\r\n    this[key] = {}; //every instances of a constructor indexed by id\r\n  };\r\n\r\n  //generate UUID (the uniqueness relies on the random factor)\r\n  this.newId = function() {\r\n    var d = Date.now(); //same as new Date().getTime()\r\n    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n        var r = (d + Math.random()*16)%16 | 0;\r\n        d = Math.floor(d/16);\r\n        return (c=='x' ? r : (r&0x3|0x8)).toString(16);\r\n    });\r\n    return uuid;\r\n  };\r\n\r\n}]);\r\n\r\nangular.module('GMAO Tailor').factory('Connection', [ 'Settings', 'AllInstances', function(Settings, AllInstances) {\r\n\r\n  AllInstances.newCollection('connection');\r\n\r\n  var canDraw = true; //a connection can be drawn ? element (service) can prevent this (connection) to draw a connection for example if an element is moving\r\n\r\n  return class Connection {\r\n    constructor(context) {\r\n      angular.merge(this, Path.Line({\r\n        from: Connection.getSegmentPosition(context.out),\r\n        to: Connection.getSegmentPosition(context.in),\r\n        strokeColor: Settings.Connection.default.strokeColor,\r\n        strokeWidth: Settings.Connection.default.strokeWidth,\r\n        data: { context: context, _id: AllInstances.newId }\r\n      }));\r\n\r\n      if (typeof context.in !== 'undefined') { //set the in connector' available to false if the property is not multiple\r\n        AllInstances.connector[context.in.connectorId].data.available = AllInstances.property[context.in.propertyIdentifier].data.definition.multiple;\r\n      }\r\n\r\n      //Events\r\n        this.onDoubleClick = function(event) {\r\n          this.remove();\r\n        };\r\n\r\n        this.onMouseEnter = function(event) {\r\n          this.strokeColor = Settings.Connection.hover.strokeColor;\r\n          this.strokeWidth = Settings.Connection.hover.strokeWidth;\r\n        };\r\n\r\n        this.onMouseLeave = function(event) {\r\n          this.strokeColor = Settings.Connection.default.strokeColor;\r\n          this.strokeWidth = Settings.Connection.default.strokeWidth;\r\n        };\r\n\r\n      AllInstances.connection[this._id] = this;\r\n    }\r\n\r\n\r\n    //Methods\r\n      actualize(side) { //side (optional) : which side has to be actualized\r\n        if (typeof side === 'undefined') {\r\n          this.firstSegment.point = Connection.getSegmentPosition(this.data.context.out);\r\n          this.lastSegment.point =  Connection.getSegmentPosition(this.data.context.in);\r\n        } else if (side === 'out') {\r\n          this.firstSegment.point = Connection.getSegmentPosition(this.data.context.out);\r\n        } else { //in (avoid to process another condition)\r\n          this.lastSegment.point =  Connection.getSegmentPosition(this.data.context.in);\r\n        }\r\n      }\r\n\r\n\r\n    //Statics\r\n      static get canDraw() {\r\n        return canDraw; //maybe this.canDraw is possible\r\n      }\r\n\r\n      static set canDraw(value) {\r\n        canDraw = value; //maybe this.canDraw is possible\r\n      }\r\n\r\n      /*\r\n      static getCanDraw() {\r\n        canDraw = true;\r\n      }\r\n\r\n      static setCanDraw(value) {\r\n        canDraw = value;\r\n      }\r\n      */\r\n\r\n      static validate(context) {\r\n        // TODO: advanced validation which will evaluate if there is any circular reference between elements and also call validator() or getter() from the properties' definition\r\n        return true;\r\n      }\r\n\r\n      static getSegmentPosition(context) { //get the position corresponding to a context (context.in || context.out)\r\n        var elementComponents = AllInstances.element[context.elementId].components,\r\n            connector = AllInstances.connector[context.connectorId];\r\n\r\n        return (elementComponents.data.reduced) ? elementComponents.children[6].position : connector.position;\r\n      }\r\n\r\n      static findById(ids) { // [ string ]\r\n        return ids.map(function(id) {\r\n          return AllInstances.connection[id];\r\n        });\r\n      }\r\n\r\n      static findByElementId(elementId, side) { //side (optional) : return only connections to which the element owns the 'in' || 'out' connector\r\n        var connectionsId;\r\n\r\n        if (typeof side !== 'undefined') {\r\n          connectionsId = Object.keys(AllInstances.connection).filter(function(connectionId) {\r\n            return AllInstances.connection[connectionId].data.context[side].elementId === elementId;\r\n          });\r\n        } else {\r\n          connectionsId = Object.keys(AllInstances.connection).filter(function(connectionId) {\r\n            var context = AllInstances.connection[connectionId].data.context;\r\n            return context.in.elementId === elementId || context.out.elementId === elementId;\r\n          });\r\n        }\r\n\r\n        return connectionsId.map(function(connectionId) {\r\n          return AllInstances.connection[connectionId];\r\n        });\r\n      }\r\n\r\n      static findOne(contextIn, contextOut) { //find one by elementId and propertyIdentifier\r\n        var foundId = Object.keys(AllInstances.connection).find(function(connectionId) {\r\n          var context = AllInstances.connection[connectionId].data.context;\r\n          return context.in.elementId === contextIn.elementId && context.in.propertyIdentifier === contextIn.propertyIdentifier &&\r\n                 context.out.elementId === contextOut.elementId && context.out.propertyIdentifier === contextOut.propertyIdentifier;\r\n        });\r\n        return AllInstances.connection[foundId];\r\n      }\r\n\r\n      static actualize(connections, side) {\r\n        connections.forEach(function(connection) {\r\n          connection.actualize(side);\r\n        });\r\n      }\r\n\r\n      static actualizeByElementId(elementId) {\r\n        angular.forEach(AllInstances.connection, function(connection, connectionId) {\r\n          if (connection.data.context.in.elementId === elementId) {\r\n            connection.actualize('in');\r\n          } else if (connection.data.context.out.elementId === elementId) {\r\n            connection.actualize('out');\r\n          }\r\n        });\r\n      }\r\n\r\n      static remove(connections) {\r\n        if (!Array.isArray(connections)) { connections = [ connections ]; }\r\n\r\n        connections.forEach(function(connection) {\r\n          AllInstances.connector[connection.data.context.in.connectorId].data.available = true;\r\n          connection.remove();\r\n          delete AllInstances.connection[connection._id];\r\n        });\r\n      }\r\n\r\n      static removeAll() {\r\n        AllInstances.newCollection('connection');\r\n      }\r\n\r\n      static import(contexts, reset) { //reset: Bool : remove all connections before import\r\n        if (!Array.isArray(contexts)) { contexts = [ contexts ]; }\r\n        if (reset) this.removeAll();\r\n\r\n        var _this = this; //Connection\r\n\r\n        contexts.forEach(function(context) {\r\n          new _this(context);\r\n        });\r\n      }\r\n\r\n      static export() {\r\n        return Object.keys(AllInstances.connection).map(function(connectionId) {\r\n          return AllInstances.connection[connectionId].data.context;\r\n        });\r\n      }\r\n\r\n  }\r\n\r\n}]);\r\n\r\nangular.module('GMAO Tailor').factory('Connector', [ 'Settings', 'AllInstances', 'Connection', 'Toast', function(Settings, AllInstances, Connection, Toast) {\r\n\r\n  AllInstances.newCollection('connector');\r\n\r\n  var connection = Path.Line({ //use to draw a connection from a connector : just a path line not a Connection\r\n    from: [ 0, 0 ],\r\n    to: [ 0, 0 ],\r\n    strokeColor: Settings.Connection.default.strokeColor,\r\n    strokeWidth: Settings.Connection.default.strokeWidth,\r\n    data: {},\r\n    visible: false\r\n  });\r\n\r\n\r\n  return class Connector {\r\n    constructor(property, coordinates, side, elementId) {\r\n      angular.merge(this, new Group({\r\n        children: [\r\n          //external circle\r\n          new Path.Circle({\r\n            center: coordinates,\r\n            radius: 6,\r\n            fillColor: new Color(Settings.Connector.styles.external[ (property.multiple) ? 'multiple' : 'default' ].fillColor),\r\n            strokeColor: Settings.Connector.styles.external[ (property.multiple) ? 'multiple' : 'default' ].strokeColor,\r\n            strokeWidth: 1,\r\n            dashArray: [ 12, 6 ]\r\n          }),\r\n          //internal circle\r\n          new Path.Circle({\r\n            center: coordinates,\r\n            radius: 1.5,\r\n            fillColor: Settings.Connector.styles.internal.available.fillColor\r\n          })\r\n        ],\r\n        data: {\r\n          isRotating: false,\r\n          totalRotation: 0,\r\n          side: side,\r\n          propertyIdentifier: property.identifier,\r\n          class: 'connector'\r\n        }\r\n      }));\r\n      if (side === 'in') this.data.available = true;\r\n\r\n      this._id = AllInstances.newId();\r\n\r\n\r\n      //Events\r\n        this.onMouseEnter = function(event) {\r\n          if (this.data.isRotating) this.scale(Settings.Connector.hover.scale);\r\n        };\r\n\r\n        this.onMouseLeave = function(event) {\r\n          if (this.data.isRotating) this.scale(1 / Settings.Connector.hover.scale);\r\n        };\r\n\r\n        this.onFrame = function(event) {\r\n          if (this.data.isRotating) { //has to rotate\r\n            this.rotate(-Settings.Connector.rotating.spin);\r\n            this.data.totalRotation += -Settings.Connector.rotating.spin;\r\n\r\n          } else if (this.data.totalRotation !== 0) { //hasn't to rotate && has to complete last rotation\r\n            if (this.data.totalRotation <= -360) this.data.totalRotation %= -360; //if |totalRotation| >= 360\r\n\r\n            var rotation = (this.data.totalRotation > -Settings.Connector.rotating.spin) ? this.data.totalRotation : -Settings.Connector.rotating.spin;\r\n            this.rotate(rotation);\r\n            this.data.isRotating = false;\r\n            this.data.totalRotation += rotation;\r\n          }\r\n        };\r\n\r\n        //only out entries can draw a connecting line\r\n        if (this.data.side === 'out') {\r\n\r\n          this.onMouseDown = function(event) {\r\n            if (Connection.canDraw) {\r\n\r\n              connection.firstSegment.point = connection.lastSegment.point = this.position;\r\n              connection.data.context.out = {\r\n                elementId: this.data.elementId,\r\n                connectorId: this._id,\r\n                propertyIdentifier: this.data.propertyIdentifier\r\n              };\r\n              connection.visible = true;\r\n\r\n              angular.forEach(AllInstances.connector, function(connector, connectorId) {\r\n                connector.data.isRotating = connector.shouldRotate('in');\r\n              });\r\n            }\r\n          };\r\n\r\n          this.onMouseDrag = function(event) {\r\n            if (connection.visible) connection.lastSegment.point = event.point;\r\n          };\r\n\r\n          this.onMouseUp = function(event) {\r\n            if (connection.visible) {\r\n              var inConnectorId = Object.keys(AllInstances.connector).find(function(connectorId) {\r\n                return AllInstances.connector[connectorId].scaling === Settings.Connector.hover.scale && connectorId !== this._id;\r\n              });\r\n\r\n              if (typeof inConnectorId === 'undefined') {\r\n                Connector.resetConnection('A connection can be made only from an Out to an In.');\r\n              } else {\r\n                var inConnector = AllInstances.connector[inConnectorId];\r\n                connection.data.context.in = {\r\n                  elementId: inConnector.data.elementId,\r\n                  connectorId: inConnector._id,\r\n                  propertyIdentifier: inConnector.data.propertyIdentifier\r\n                };\r\n\r\n                if (Connection.validate(connection.data.context)) { //high verification : to avoid any illogical connection\r\n                  inConnector.data.available = AllInstances.property[inConnector.data.propertyIdentifier].data.definition.multiple;\r\n                  new Connection(connection.data.context);\r\n                  Connector.resetConnection();\r\n                }\r\n              }\r\n\r\n\r\n              angular.forEach(AllInstances.connector, function(connector, connectorId) {\r\n                connector.shouldRotate('out');\r\n              });\r\n            }\r\n          };\r\n        }\r\n\r\n\r\n      AllInstances.connector[this._id] = this;\r\n    }\r\n\r\n\r\n    //Methods\r\n      shouldRotate(side) { //which side should rotate if a connection with this (connector) is valid\r\n        if (side !== this.data.side) {\r\n          this.data.isRotating = false;\r\n\r\n        } else if (this.data.side === 'out') { //side === this.data.side === 'out'\r\n          this.data.isRotating = true;\r\n\r\n        } else if (this.data.available) { //side === this.data.side === 'in' && available\r\n\r\n          if (connection.data.context.out.elementId !== this.data.elementId) { //not the same element\r\n            var thisType = AllInstances.property[this.data.propertyIdentifier].data.definition.type; // [ String ]\r\n\r\n            var typeValid = thisType.indexOf('all') > -1 || thisType.some(function(type) {\r\n              return AllInstances.property[connection.data.context.out.propertyIdentifier].data.definition.type.indexOf(type) > -1;\r\n            });\r\n\r\n            if (typeValid) {\r\n              var alreadyExist = Connection.findOne(\r\n                { elementId: this.data.elementId, propertyIdentifier: this.data.propertyIdentifier }, //In\r\n                connection.data.context.out //Out\r\n              );\r\n\r\n              this.data.isRotating = typeof alreadyExist === 'undefined';\r\n            } else {\r\n              this.data.isRotating = false;\r\n            }\r\n          } else {\r\n            this.data.isRotating = false;\r\n          }\r\n        } else {\r\n          this.data.isRotating = false;\r\n        }\r\n      }\r\n\r\n\r\n    //Statics\r\n      static get connection() {\r\n        return connection; //maybe this.connection is possible\r\n      }\r\n\r\n      static set connection(value) {\r\n        connection = value; //maybe this.connection is possible\r\n      }\r\n\r\n      static resetConnection(msg) { //optional: if message then error;\r\n        connection.visible = false;\r\n        if (msg) Toast.error(msg);\r\n      }\r\n\r\n      static findOne(elementId, propertyIdentifier) { //find one by elementId and propertyIdentifier\r\n        return AllInstances.connector[this.findOneId(elementId, propertyIdentifier)];\r\n      }\r\n\r\n      static findOneId(elementId, propertyIdentifier) { //find one by elementId and propertyIdentifier\r\n        return Object.keys(AllInstances.connector).find(function(connectorId) {\r\n          var connector = AllInstances.connector[connectorId];\r\n          return connector.data.elementId === elementId && connector.data.propertyIdentifier === propertyIdentifier;\r\n        });\r\n      }\r\n  };\r\n\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').factory('Definition', [ 'AllInstances', function(AllInstances) {\r\n\r\n  AllInstances.newCollection('definition');\r\n\r\n\r\n  return class Definition {\r\n    constructor(definition) {\r\n      angular.merge(this, definition);\r\n\r\n      AllInstances.definition[this._id] = this;\r\n    }\r\n\r\n\r\n    //Methods\r\n      getVersion(versionName) {\r\n        return this.versions.find(function(version) {\r\n          return version.name === versionName;\r\n        });\r\n      }\r\n\r\n\r\n    //Statics\r\n      static import(definitions, reset) { //reset: Bool : remove all definitions before import\r\n        if (reset) AllInstances.newCollection('definition');\r\n        var _this = this;\r\n\r\n        definition.forEach(function(definition) {\r\n          new _this(definition);\r\n        });\r\n      }\r\n  };\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').factory('Element', [ 'Settings', 'AllInstances', 'Connection', 'Connector', function(Settings, AllInstances, Connection, Connector) {\r\n\r\n  AllInstances.newCollection('element');\r\n\r\n  return class Element {\r\n    constructor(element) { //element (optional)\r\n      var _this = this;\r\n\r\n      //Init\r\n        var defaultAttributes = {\r\n          name: '',\r\n          description: '',\r\n          _id: AllInstances.newId()\r\n        };\r\n\r\n        angular.extend(this, defaultAttributes, element);\r\n\r\n        var definiton = AllInstances.definition[this.definition];\r\n        var version = definiton.getVersion(this.version);\r\n\r\n\r\n        //Coordinates\r\n          function getMaxLength(properties) {\r\n            return Math.max.apply(null, properties.map(function(property) {\r\n              return property.name.length;\r\n            }));\r\n          }\r\n\r\n          if (typeof this.coordinates === 'undefined') {\r\n            var propertiesMaxLength = getMaxLength(version.properties.in) + getMaxLength(version.properties.out) + 4;\r\n\r\n            var width =  Math.max(propertiesMaxLength, definition.name.length, this.name) * 9 + 75; //75 for the padding where connectors will be\r\n            var height = Math.max(version.properties.in.length, version.properties.out.length) * 40 + 50; //50 for the header and 40 for each property lines\r\n\r\n            this.coordinates = {\r\n              x: view.center.x - width / 2,\r\n              y: view.center.y - height / 2,\r\n              width: width,\r\n              height: height\r\n            };\r\n          }\r\n\r\n\r\n      //Main\r\n        var main = {\r\n\r\n          background: new Path.Rectangle({\r\n            rectangle: new Rectangle(this.coordinates),\r\n            fillColor: Settings.element.styles.rectPath.unselected.fillColor,\r\n            data: {\r\n              elementId: _this.id\r\n            }\r\n          })\r\n\r\n        };\r\n\r\n\r\n      //Header\r\n        var header = {\r\n\r\n          background: new Path.Rectangle({\r\n            rectangle: new Rectangle(_this.coordinates.x, _this.coordinates.y, _this.coordinates.width, 50),\r\n            fillColor: Settings.element.styles.rectHeaderPath.unselected.fillColor,\r\n            data: {\r\n              elementId: _this.id,\r\n              class: 'header'\r\n            }\r\n          }),\r\n\r\n          elementName: new PointText({\r\n            point: [ _this.coordinates.x + _this.coordinates.width / 2, _this.coordinates.y + 20 ],\r\n            content: _this.name,\r\n            fillColor: Settings.element.styles.textHeader.fillColor,\r\n            justification: 'center',\r\n            fontFamily: Settings.element.styles.textHeader.fontFamily,\r\n            fontWeight: Settings.element.styles.textHeader.fontWeight,\r\n            fontSize: Settings.element.styles.textHeader.fontSize\r\n          }),\r\n\r\n          definitionName: new PointText({\r\n            point: [ _this.coordinates.x + _this.coordinates.width / 2, _this.coordinates.y + 45 ],\r\n            content: definition.name,\r\n            fillColor: Settings.element.styles.textHeader.fillColor,\r\n            justification: 'center',\r\n            fontFamily: Settings.element.styles.textHeader.fontFamily,\r\n            fontWeight: Settings.element.styles.textHeader.fontWeight,\r\n            fontSize: Settings.element.styles.textHeader.fontSize * 0.75,\r\n            data: {\r\n              elementId: _this.id\r\n            }\r\n          }),\r\n\r\n          in: new PointText({\r\n            point: [ _this.coordinates.x + 20, _this.coordinates.y + 45 ],\r\n            content: 'In',\r\n            fillColor: Settings.element.styles.textHeader.fillColor,\r\n            justification: 'left',\r\n            fontFamily: Settings.element.styles.textHeader.fontFamily,\r\n            fontWeight: Settings.element.styles.textHeader.fontWeight,\r\n            fontSize: Settings.element.styles.textHeader.fontSize\r\n          }),\r\n\r\n          out: new PointText({\r\n            point: [ _this.coordinates.x + _this.coordinates.width - 20, _this.coordinates.y + 45 ],\r\n            content: 'Out',\r\n            fillColor: Settings.element.styles.textHeader.fillColor,\r\n            justification: 'right',\r\n            fontFamily: Settings.element.styles.textHeader.fontFamily,\r\n            fontWeight: Settings.element.styles.textHeader.fontWeight,\r\n            fontSize: Settings.element.styles.textHeader.fontSize\r\n          })\r\n\r\n        };\r\n\r\n        header.background.onDoubleClick = function(event) {\r\n          _this.toggleSelection();\r\n        };\r\n\r\n        header.definitionName.onDoubleClick = function(event) {\r\n           _this.toggleReduction();\r\n        };\r\n\r\n\r\n      //Regroup components\r\n        this.components = new Group({\r\n          children: [ main.background, header.background, header.elementName, header.definitionName, header.in, header.out ],\r\n          data: {\r\n            class: 'element',\r\n            elementId: this.id,\r\n            connectors: new Group(),\r\n            //connections: [], // [ Connection._id ]\r\n            reduced: false,\r\n            selected: false\r\n          }\r\n        });\r\n\r\n\r\n      //Properties\r\n        function createProperties(properties, side) {\r\n          properties.forEach(function(property, index) {\r\n            var coordinates = new Point( (side === 'in') ? _this.coordinates.x + 20 : _this.coordinates.x + _this.coordinates.width - 20, _this.coordinates.y + 70 + index * 40);\r\n\r\n            var connector = new Connector(property, coordinates, side, elementId);\r\n\r\n            var text = new PointText({\r\n              point: [ (side === 'in') ? coordinates.x + 20 : coordinates.x - 20, coordinates.y ],\r\n              content: property.name,\r\n              fillColor: Settings.element.styles.colors[ (property.required) ? 'required' : 'notRequired' ],\r\n              justification: (side === 'in') ? 'left' : 'right',\r\n              fontFamily: Settings.element.styles.propertyText.fontFamily,\r\n              fontWeight: (property.required) ? Settings.element.styles.font.required : Settings.element.styles.font.notRequired,\r\n              fontSize: Settings.element.styles.propertyText.fontSize,\r\n              data: {\r\n                propertyIdentifier: property.identifier,\r\n                elementId: _this._id,\r\n                class: 'propertyName'\r\n              }\r\n            });\r\n\r\n            text.onDoubleClick = function(event) {\r\n              AllInstances.element[this.data.elementId].toggleReduction();\r\n            };\r\n\r\n            this.components.addChildren([ connector, property ]);\r\n          });\r\n        }\r\n\r\n        var inProperties = createProperties(version.properties.in, 'in');\r\n        var outProperties = createProperties(version.properties.out, 'out');\r\n\r\n\r\n      //Events\r\n        elementGroup.onMouseDown = function(event) {\r\n          Connection.canDraw = false;\r\n          event.delta = new Point(0, 0); //reset delta (distance between two event)\r\n        };\r\n\r\n        elementGroup.onMouseDrag = function(event) {\r\n          if (this.data.selected) {\r\n            AllInstances.layer.Selected.getElements().forEach(function(element) {\r\n              element.move(event.delta);\r\n            });\r\n          } else {\r\n            this.move(event.delta);\r\n          }\r\n        };\r\n\r\n        elementGroup.onMouseUp = function() {\r\n          Connection.canDraw = true;\r\n        };\r\n\r\n\r\n      AllInstances.element[this._id] = this;\r\n    }\r\n\r\n\r\n    //Methods\r\n      move(delta) {\r\n        this.coordinates.x += delta.x;\r\n        this.coordinates.y += delta.y;\r\n\r\n        this.components.position = this.coordinates;\r\n\r\n        Connection.actualizeByElementId(this._id);\r\n      }\r\n\r\n      toggleReduction() {\r\n        return this.setReduction(!this.components.data.reduced);\r\n      }\r\n\r\n      setReduction(value) {\r\n        this.components.children.forEach(function(child, index) {\r\n          if (index < 1 || index > 5) child.visible = !value; //every component except ones from the header\r\n        });\r\n        this.components.data.reduced = value;\r\n\r\n        Connection.actualizeByElementId(this._id);\r\n\r\n        if (value) {\r\n          AllInstances.layer.Reduced.elements.push(this._id);\r\n        } else {\r\n          var index = AllInstances.layer.Reduced.elements.indexOf(this._id);\r\n          if (index > -1) AllInstances.layer.Reduced.elements.splice(index, 1);\r\n        }\r\n      }\r\n\r\n      toggleVisibility() {\r\n        return this.setVisibility(!this.components.visible);\r\n      }\r\n\r\n      setVisibility(value) {\r\n        this.components.visible = value;\r\n\r\n        Connection.findByElementId(this._id).forEach(function(connection) {\r\n          connection.visible = value;\r\n        });\r\n\r\n        if (value) {\r\n          AllInstances.layer.Visible.elements.push(this._id);\r\n        } else {\r\n          var index = AllInstances.layer.Visible.elements.indexOf(this._id);\r\n          if (index > -1) AllInstances.layer.Visible.elements.splice(index, 1);\r\n        }\r\n      }\r\n\r\n      toggleSelection() {\r\n        return this.setReduction(!this.components.data.selected);\r\n      }\r\n\r\n      setSelection(value) {\r\n        var state = (value) ? 'selected' : 'default';\r\n        this.components.children[0].style.fillColor = Settings.Element[state].main.background.fillcolor;\r\n        this.components.children[1].style.fillColor = Settings.Element[state].header.background.fillcolor;\r\n\r\n        this.components.data.selected = value;\r\n\r\n        if (value) {\r\n          AllInstances.layer.Selected.elements.push(this._id);\r\n        } else {\r\n          var index = AllInstances.layer.Selected.elements.indexOf(this._id);\r\n          if (index > -1) AllInstances.layer.Selected.elements.splice(index, 1);\r\n        }\r\n      }\r\n\r\n      getDefinition() {\r\n        var definition = angular.merge({}, AllInstances.definition[this.definition]); //copy\r\n\r\n        return {\r\n          name: definition.name,\r\n          description: definition.description,\r\n          version: definition.getVersion(this.version),\r\n          author: definition.author,\r\n          _id: definition._id\r\n        };\r\n      }\r\n\r\n\r\n    //Statics\r\n      static toggleReduction(elementIds, same) { //same (Bool, optional): every elements will have the property\r\n        if (!Array.isArray(elementIds)) { elementIds = [ elementIds ]; }\r\n\r\n        if (same) {\r\n          var reduction = !AllInstances.element[ elementIds[0] ].components.data.reduced; //to have the same effect on every given elements\r\n          elementIds.forEach(function(elementId) {\r\n            AllInstances.element[elementId].setReduction(reduction);\r\n          });\r\n\r\n        } else {\r\n          elementIds.forEach(function(elementId) {\r\n            AllInstances.element[elementId].toggleReduction();\r\n          });\r\n        }\r\n      }\r\n\r\n      static toggleVisibility(elementIds, same) { //same (Bool, optional): every elements will have the property\r\n        if (!Array.isArray(elementIds)) { elementIds = [ elementIds ]; }\r\n\r\n        if (same) {\r\n          var visibility = !AllInstances.element[ elementIds[0] ].components.visible; //to have the same effect on every given elements\r\n          elementIds.forEach(function(elementId) {\r\n            AllInstances.element[elementId].setVisibility(visibility);\r\n\r\n          });\r\n        } else {\r\n          elementIds.forEach(function(elementId) {\r\n            AllInstances.element[elementId].toggleVisibility();\r\n          });\r\n        }\r\n      }\r\n\r\n      static toggleSelection(elementIds, same) { //same (Bool, optional): every elements will have the property\r\n        if (!Array.isArray(elementIds)) { elementIds = [ elementIds ]; }\r\n\r\n        if (same) {\r\n          var selection = !AllInstances.element[ elementIds[0] ].components.data.selected; //to have the same effect on every given elements\r\n          elementIds.forEach(function(elementId) {\r\n            AllInstances.element[elementId].setSelection(selection);\r\n          });\r\n\r\n        } else {\r\n          elementIds.forEach(function(elementId) {\r\n            AllInstances.element[elementId].toggleSelection();\r\n          });\r\n        }\r\n      }\r\n\r\n      static toggleSelectionAll(same) { //same (Bool, optional): every elements will have the property\r\n        if (same) {\r\n          var selection = !AllInstances.element[Object.keys(AllInstances.element)[0]].components.data.selected; //to have the same effect on every given elements\r\n          angular.forEach(AllInstances.element, function(element, elementId) {\r\n            element.setSelection(selection);\r\n          });\r\n\r\n        } else {\r\n          angular.forEach(AllInstances.element, function(element, elementId) {\r\n            element.toggleSelection();\r\n          });\r\n        }\r\n      }\r\n\r\n      static copySelected() {\r\n        AllInstances.layer.Copied.elements = AllInstances.layer.Selected.elements.slice();\r\n      }\r\n\r\n      static pasteCopied() {\r\n        this.duplicate(AllInstances.layer.Copied.elements);\r\n      }\r\n\r\n      static duplicate(elementIds) {\r\n        if (!Array.isArray(elementIds)) { elementIds = [ elementIds ]; }\r\n\r\n        var connections = {}; //every connections to duplicate indexed by _id => avoid duplications\r\n\r\n        var copyElements = elementIds.map(function(elementId) {\r\n          var element = AllInstances.element[elementId];\r\n          Connection.findByElementId(elementId).forEach(function(connection) { connections[connection._id] = connection; });\r\n\r\n          return new Element(angular.merge({}, element, { _id: AllInstances.newId() }));\r\n        });\r\n\r\n\r\n        function updateContext(context, side) {\r\n          var index = elementIds.indexOf(context[side].elementId);\r\n\r\n          if (index > -1) {\r\n            context[side].elementId = copyElements[index].elementId;\r\n            context[side].connectorId = Connector.findOneId(context[side].elementId, context[side].propertyIdentifier);\r\n          }\r\n        }\r\n\r\n        angular.forEach(connections, function(connection, connectionId) {\r\n          var newContext = angular.merge({}, connection.data.context);\r\n\r\n          updateContext(newContext, 'in');\r\n          updateContext(newContext, 'out');\r\n\r\n          new Connection(newContext);\r\n        });\r\n      }\r\n\r\n      static delete(elements) {\r\n        if (!Array.isArray(elements)) { elements = [ elements ]; }\r\n\r\n        elements.forEach(function(element) {\r\n          element.components.remove();\r\n          Connection.remove(Connection.findByElementId(element._id));\r\n\r\n          angular.forEach(AllInstances.layer, function(layer, layerId) {\r\n            var index = layer.elements.indexOf(element.id);\r\n            if (index > -1) layer.elements.splice(index, 1);\r\n          });\r\n\r\n          delete AllInstances.element[element._id];\r\n        });\r\n      }\r\n\r\n      static import(elements) {\r\n        if (!Array.isArray(elements)) { elements = [ elements ]; }\r\n        var _this = this;\r\n\r\n        elements.forEach(function(element) {\r\n          new _this(element);\r\n        });\r\n      }\r\n\r\n      static export(elements) {\r\n        if (!Array.isArray(elements)) { elements = [ elements ]; }\r\n\r\n        return elements.map(function(element) {\r\n          return {\r\n            name: element.name,\r\n            description: element.description,\r\n            coordinates: element.coordinates,\r\n            version: element.version,\r\n            definition: element.definition,\r\n            _id: element._id\r\n          };\r\n        });\r\n      }\r\n\r\n      static exportAll() {\r\n        return Object.keys(AllInstances.element).map(function(elementId) {\r\n          var element = AllInstances.element[elementId];\r\n\r\n          return {\r\n            name: element.name,\r\n            description: element.description,\r\n            coordinates: element.coordinates,\r\n            version: element.version,\r\n            definition: element.definition,\r\n            _id: element._id\r\n          };\r\n        });\r\n      }\r\n\r\n  }\r\n\r\n}]);\r\n\r\n\nangular.module('GMAO Tailor').service('Global', [ 'Settings', 'Element', 'Connection', function(Settings, Element, Connection) {\n\n\n  //Keybindings\n    var eventHandlers = {\n\n      onKeyDown: {\n        toggleSelectAll: function(event) {\n          Element.toggleSelectionAll();\n        },\n        inverseSelection: function(event) {\n          Element.toggleSelectionAll();\n        },\n        copySelected: function(event) {\n          Element.copySelected();\n        },\n        pasteCopied: function(event) {\n          Element.pasteCopied();\n        },\n        deleteSelected: function(event) {\n          AllInstances.layer.Selected.deleteAllElements();\n        },\n        restoreZoom: function(event) {\n          view.zoom = Settings.view.zoom.value;\n        },\n        plusZoom: function(event) {\n          view.zoom += view.zoom * Settings.view.zoom.pitch;\n        },\n        minusZoom: function(event) {\n          if (view.zoom - view.zoom * Settings.view.zoom.pitch > Math.max(0.01, Settings.view.zoom.pitch)) { //avoid bug because to close to 0\n            view.zoom -= view.zoom * Settings.view.zoom.pitch;\n          }\n        },\n        centerView: function(event) {\n          view.center = project.activeLayer.position;\n        },\n        center: function(event) {\n          //center on the view if there are not any elements selected\n          if (AllInstances.layer.Selected.elements.length === 0) {\n            eventHandlers.onKeyDown.centerView();\n\n          } else { //center the elements selected\n            var selectedElements = AllInstances.layer.Selected.elements.map(function(element) {\n              return AllInstances.elements[element.id].data.components;\n            });\n\n            var groupSelectedElements = new Group(selectedElements);\n            view.center = groupSelectedElements.position;\n\n            //remove the group (and re-insert its children into the view instead of remove them too)\n            project.activeLayer.addChildren(groupSelectedElements.removeChildren());\n          }\n        }\n      },\n\n      onMouseDown: {\n        move: function(event) { //move the view (actually project.activeLayer)\n          event.delta = new Point(0, 0); //to start the delta (distance between two last mouse events)\n        },\n        select: function(event) {\n          selection.segments[1].point = event.point; //origin\n          selection.visible = true;\n        },\n        deselect: function(event) {\n          if (AllInstances.layer.Selected.elements.length > 0) {\n            deselection.segments[1].point = event.point; //origin\n            deselection.visible = true;\n          } else {\n            return false; //action not valid so by returning false it will not become the currentAction\n          }\n        }\n      },\n\n      onMouseDrag: {\n        move: function(event) { //move the view (actually activeLayer.project)\n          project.activeLayer.position += event.delta;\n        },\n        select: function(event) {\n          selection.updateBottomRight(event.point);\n        },\n        deselect: function(event) {\n          deselection.updateBottomRight(event.point);\n        }\n      },\n\n      onMouseUp: {\n        select: function(event) {\n          selection.processContent();\n        },\n        deselect: function(event) {\n          deselection.processContent();\n        }\n      }\n\n    };\n\n    function triggerAction(event, eventHandler) { //eventHandler: eventHandlers.*\n      var actionName = Object.keys(eventHandler).find(function(actionName) {\n        return Settings.keybindings[actionName].some(function(keys) { //verify if one of the keybindings at a time\n          return keys.every(function(key) { //verify if every key is pressed\n            return (event.modifiers[key] || typeof event.modifiers[key] === 'undefined') || //key is a modifier and is pressed || it's not a modifier ans it's not pressed\n                    key === event.key || //key is the key which trigger the event\n                    Key.isDown(key); //key is hold\n          });\n        });\n      });\n\n      return (typeof actionName === 'undefined') ? null : (eventHandlers.onMouseDown[actionName](event) === false) ? null : actionName; //=== false because it can be undefined too\n    }\n\n\n  //Box : rectangle to select or deselect\n    class Box {\n      constructor(type) { //'select' || 'deselect'\n        angular.merge(this, new Path.Rectangle({\n          from: [ 0, 0 ],\n          to: [ 0, 0 ],\n          strokeColor: Settings.Global[type].strokeColor,\n          strokeWidth: Settings.Global[type].strokeWidth,\n          fillColor: Settings.Global[type].fillColor,\n          visible: false\n        }));\n\n        this.type = type;\n      }\n\n\n      //Methods\n        updateBottomRight(point) {\n          rectangle.segments[3].point = point; //rightBottom point => where the mouse is\n\n          rectangle.segments[2].point.x = point.x; //rightTop point\n          rectangle.segments[0].point.y = point.y; //leftBottom point\n        }\n\n        processContent() {\n          var _this = this,\n              data = (this.type === 'selection') ? { class: 'element' } : { class: 'element', selected: true },\n\n              overlapping = project.activeLayer.getItems({ overlapping: this.bounds, data: data }),\n              inside = project.activeLayer.getItems({ inside: this.bounds, data: data });\n\n          overlapping.concat(inside).forEach(function(elementComponents) {\n            AllInstances.element[elementComponents.data.elementId][_this.type]();\n          });\n\n          this.visible = false;\n        }\n    }\n\n\n  //Init\n    var tool = new Tool(),\n        currentAction = null,\n        selection = new Box('selection'),\n        deselection = new Box('deselection');\n\n    view.zoom = Settings.view.zoom.value;\n\n\n  //Events\n    tool.onKeyDown = function(event) {\n      event.point = view.getEventPoint(event); //there isn't any mouse coordinates on key events\n      //if (contextMenu.visible) contextMenu.close();\n\n      if (!Connector.connection.visible) {\n        triggerAction(event, eventHandlers.onKeyDown);\n      }\n    };\n\n    tool.onMouseDown = function(event) {\n      var hitTest = project.activeLayer.hitTest(event.point); //return an object with the item as its item key or undefined if nothing is hit\n\n      if (!hitTest) { //if mouse down on the canvas and not on any paper js item then ...\n        currentAction = triggerAction(event, eventHandlers.onMouseDown);\n\n        console.log('hitTest', hitTest); //need to know what is hit first, if random or not\n\n        if (selection.visible || deselection.visible) { //deselect if click outside selected elements\n          var rect = new Rectangle({ x: event.point.x - 0.05, y: event.point.y - 0.05, width: 0.1, height: 0.1 });\n\n          if (!event.modifiers.shift && !event.modifiers.control &&\n                AllInstances.layer.Selected.elements.length > 0 &&\n                  (!hitTest ||\n                  !project.activeLayer.getItem({ overlapping: rect, data: { selected: true } }) &&\n                    !project.activeLayer.getItem({ overlapping: rect, data: { class: 'header' } }))) {\n\n            Element.deselect(AllInstances.layer.Selected.elements);\n          }\n        }\n\n      }\n    };\n\n    tool.onMouseDrag = function(event) {\n      if (currentAction) eventHandlers.onMouseDrag[currentAction](event);\n    };\n\n    tool.onMouseUp = function(event) {\n      if (currentAction) {\n        eventHandlers.onMouseUp[currentAction](event);\n        currentAction = null;\n      }\n    };\n\n\n}]);\n\r\n\r\nangular.module('GMAO Tailor').factory('Layer', [ '$mdDialog', 'AllInstances', 'Element', function($mdDialog, AllInstances, Element) {\r\n\r\n  AllInstances.newCollection('layer');\r\n\r\n\r\n  class Layer {\r\n    constructor(layer) { // { name: String, description: String, elements: [ Element.id ] }\r\n      var defaultAttributes = { description: '', elements: [], _id: AllInstances.newId() };\r\n      angular.merge(this, defaultAttributes, layer);\r\n\r\n      AllInstances.layer[this._id] = this;\r\n    }\r\n\r\n\r\n    //Methods\r\n      getElements() {\r\n        return this.elements.map(function(elementId) {\r\n          return AllInstances.element[elementId];\r\n        });\r\n      }\r\n\r\n      removeElement(index) {\r\n        this.elements.splice(index, 1);\r\n      }\r\n\r\n      removeAllElements() {\r\n        Element.delete(this.getElements());\r\n      }\r\n\r\n\r\n    //Statics\r\n      static get all() {\r\n        return AllInstances.layer.All;\r\n      }\r\n\r\n      static set all(value) {\r\n        AllInstances.layer.All = value;\r\n      }\r\n\r\n      static get selected() {\r\n        return AllInstances.layer.Selected;\r\n      }\r\n\r\n      static set selected(value) {\r\n        AllInstances.layer.Selected = value;\r\n      }\r\n\r\n      static create(event, elements) {\r\n        var _this = this;\r\n\r\n        $mdDialog.show({ //ask name and description\r\n          controller: 'NewLayerDialogCtrl',\r\n          templateUrl: 'templates/components/newLayerDialog.html',\r\n          parent: angular.element(document.body),\r\n          targetEvent: event,\r\n          clickOutsideToClose: true\r\n        })\r\n        .then(function(layer) { //given by $mdDialog.hide()\r\n          layer.elements = elements.slice(); //just ids\r\n          new _this(layer);\r\n\r\n        }, function() { //cancel\r\n          //nothing to do\r\n        });\r\n      }\r\n\r\n      static deleteAll() { //remove all layers (except 'All' && 'Selected')\r\n        angular.forEach(AllInstances.layer, function(layer, layerId) {\r\n          if (layerId.length > 8) delete AllInstances.layer[layerId]; //not 'All', 'Selected', 'Visible', 'Reduced' or 'Copied'\r\n        });\r\n      }\r\n\r\n      static import(layers, reset) { //reset: Bool : remove all layers (except 'All' && 'Selected') before import\r\n        if (reset) this.deleteAll();\r\n        var _this = this;\r\n\r\n        layers.forEach(function(layer) {\r\n          new _this(layer);\r\n        });\r\n      }\r\n\r\n      static export(layers) {\r\n        if (!Array.isArray(layers)) { layers = [ layers ]; }\r\n\r\n        return layers.filter(function(layer) {\r\n                        return layer._id.length > 8; //not 'All', 'Selected', 'Visible', 'Reduced' or 'Copied'\r\n                      })\r\n                      .map(function(layer) {\r\n                        return {\r\n                          name: layer.name,\r\n                          description: layer.description,\r\n                          elements: layer.elements\r\n                        };\r\n                      });\r\n      }\r\n\r\n      static exportAll() {\r\n        return Object.keys(AllInstances.layer)\r\n          .filter(function(layerId, index) {\r\n            return index > 4; //not 'All', 'Selected', 'Visible', 'Reduced' or 'Copied'\r\n          })\r\n          .map(function(layerId) {\r\n            var layer = AllInstances.layer[layerId];\r\n\r\n            return {\r\n              name: layer.name,\r\n              description: layer.description,\r\n              elements: layer.elements\r\n            };\r\n          });\r\n      }\r\n  }\r\n\r\n\r\n  new Layer({ name: 'All', description: 'All drawn elements', _id: 'All' });\r\n  new Layer({ name: 'Selected', description: 'All selected elements', _id: 'Selected' });\r\n  new Layer({ name: 'Visible', description: 'All visible elements', _id: 'Visible' });\r\n  new Layer({ name: 'Reduced', description: 'All reduced elements', _id: 'Reduced' });\r\n  new Layer({ name: 'Copied', description: 'All copied elements', _id: 'Copied' });\r\n\r\n\r\n  return Layer;\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').service('comparatorsElements', [ function() {\r\n\r\n  this.addTo = function(elementsDefinition) { //the service 'elementsDefinition' calls the method 'add' of every services with blueprint elements with 'this' as the parameter. So 'elementsDefinition' gains more keys and can hold every elements\r\n\r\n    elementsDefinition.egal = {\r\n      name: 'Egal',\r\n      properties: [\r\n        { name: 'elements', type: 'array', arrayOf: [ 'mixed' ], required: true }, //mixed egals to all types\r\n        { name: 'strictly egal (===)', keyName: 'strictlyEgal', type: 'bool', default: false }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'bool',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values.elements.every(function(currentValue, index, array) {\r\n            return (values.strictlyEgal) ? array[0] === currentValue : array[0] == currentValue;\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.higher = {\r\n      name: 'Higher',\r\n      properties: [\r\n        { name: 'number(s)', keyName:'highers', type: 'array', arrayOf: [ 'number', 'date' ], required: true },\r\n        { name: '> number(s)', keyName:'lowers', type: 'array', arrayOf: [ 'number', 'date' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'bool',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          var lowersHighest = values.lowers.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n            return (previousValue > currentValue) ? previousValue : currentValue;\r\n          });\r\n\r\n          return values.highers.every(function(currentValue, index, array) {\r\n            return currentValue > lowersHighest;\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.lower = {\r\n      name: 'Lower',\r\n      properties: [\r\n        { name: 'number(s)', keyName:'lowers', type: 'array', arrayOf: [ 'number', 'date' ], required: true },\r\n        { name: '< number(s)', keyName:'highers', type: 'array', arrayOf: [ 'number', 'date' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'bool',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          var lowersHighest = values.lowers.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n            return (previousValue > currentValue) ? previousValue : currentValue;\r\n          });\r\n\r\n          return values.highers.every(function(currentValue, index, array) {\r\n            return currentValue > lowersHighest;\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.higherOrEgal = {\r\n      name: 'Higher or Egal',\r\n      properties: [\r\n        { name: 'number(s)', keyName:'highers', type: 'array', arrayOf: [ 'number', 'date' ], required: true },\r\n        { name: '>= number(s)', keyName:'lowers', type: 'array', arrayOf: [ 'number', 'date' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'bool',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          var lowersHighest = values.lowers.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n            return (previousValue > currentValue) ? previousValue : currentValue;\r\n          });\r\n\r\n          return values.highers.every(function(currentValue, index, array) {\r\n            return currentValue >= lowersHighest;\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.lowerOrEgal = {\r\n      name: 'Lower or Egal',\r\n      properties: [\r\n        { name: 'number(s)', keyName:'lowers', type: 'array', arrayOf: [ 'number', 'date' ], required: true },\r\n        { name: '<= number(s)', keyName:'highers', type: 'array', arrayOf: [ 'number', 'date' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'bool',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          var lowersHighest = values.lowers.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n            return (previousValue > currentValue) ? previousValue : currentValue;\r\n          });\r\n\r\n          return values.highers.every(function(currentValue, index, array) {\r\n            return currentValue >= lowersHighest;\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n  };\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').service('formInputsElements', [ function() {\r\n\r\n  this.addTo = function(elementsDefinition) { //the service 'elementsDefinition' calls the method 'add' of every services with blueprint elements with 'this' as the parameter. So 'elementsDefinition' gains more keys and can hold every elements\r\n\r\n    elementsDefinition.Input_ = {\r\n      name: 'Input*',\r\n      properties: [ //all the commun properties to all the BlueprintTypes (never used alone, has to be a specific type of BlueprintType)\r\n        { name: 'name', type: 'string', required: true, description: 'The name given to the form input which the user has to complete.' },\r\n        { name: 'description', type: 'string', description: 'A description to explain to what corresponds this form input.' },\r\n        { name: 'helper', type: 'string', description: 'A quick text to explain what reponse the user should give you.' },\r\n        { name: 'visibility', type: 'string', enum: [ 'reduce-panel', 'extend-panel', 'full-panel', 'full-panel-reduce' ], default: 'full-panel', description: 'The visibility allows you to choose to display or not this form input according to the state of diplay of the form.' },\r\n        { name: 'required', type: 'bool', default: false, description: 'Does the user absolutly need to fullfill this form input ?' },\r\n        { name: 'disabled', type: 'bool', default: false, description: 'Is this form input disabled ?' }\r\n      ]\r\n    };\r\n\r\n    elementsDefinition.Input_String = {\r\n      name: 'Input String',\r\n      description: 'Ask the user to return a string (a text) throught a form. This string will have to match the properties that you will set below.',\r\n      properties: [\r\n        { name: 'enum', type: 'array', arrayOf: [ 'enum' ], description: 'If you want to allow only some choices to this input. Indeed an enum is one of the available answer to the input. The type of the enum must correspond to the type of the value returned by the input.' },\r\n        { name: 'match RegHex', type: 'RegHex', description: 'If you want that the value given by the user matchs some complexe criterias, you can give it a RegHex expression.' },\r\n        { name: 'uppercase', type: 'bool', default: false, description: 'The value returned by the user should be converted into uppercase ?' },\r\n        { name: 'lowercase', type: 'bool', default: false, description: 'The value returned by the user should be converted into lowercase ?' },\r\n        { name: 'maxlength', type: 'number', description: 'How much the lenght of the returned value can be long ?' },\r\n        { name: 'minlength', type: 'number', description: 'How much the lenght of the returned value can be short ?' }\r\n      ],\r\n      value: {\r\n        name: 'string',\r\n        type: 'string',\r\n        description: 'The returned value : a string.',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.Input_Number = {\r\n      name: 'Input Number',\r\n      description: 'Ask the user to return a number throught a form. This number will have to match the properties that you will set below.',\r\n      properties: [\r\n        { name: 'enum', type: 'array', arrayOf: [ 'enum' ] },\r\n        { name: 'max', type: 'number', description: 'How much the returned value can be high ?' },\r\n        { name: 'min', type: 'number', description: 'How much the returned value can be low ?' }\r\n      ],\r\n      value: {\r\n        name: 'number',\r\n        type: 'number',\r\n        description: 'The returned value : a number.',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.Input_Date = {\r\n      name: 'Input Date',\r\n      description: 'Ask the user to return a date throught a form. This date will have to match the properties that you will set below.',\r\n      properties: [\r\n        { name: 'enum', type: 'array', arrayOf: [ 'enum' ] },\r\n        { name: 'format', type: 'string', default: 'medium', description: 'How the date should be display ? Check out angular ng-date doc or something like that' },\r\n        { name: 'max', type: 'date', description: 'How much the returned value can be in the futur ?' },\r\n        { name: 'min', type: 'date', description: 'How much the returned value can be in the past ?' }\r\n      ],\r\n      value: {\r\n        name: 'date',\r\n        type: 'date',\r\n        description: 'The returned value : a date.',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.Input_Boolean = {\r\n      name: 'Input Bool',\r\n      description: 'Ask the user to return a boolean (true or false) throught a form. This boolean will have to match the properties that you will set below.',\r\n      properties: [\r\n        { name: 'false option', keyName: 'falseOption', type: 'boolOption', description: 'A Bool Option to attribute an other value to true (then true).' },\r\n        { name: 'true option', keyName: 'trueOption', type: 'boolOption', description: 'A Bool Option to attribute an other value to false (then false).' }\r\n      ],\r\n      value: {\r\n        name: 'bool',\r\n        type: 'bool',\r\n        description: 'The returned value : bool or the value corresponding to the Bool Option of the returned value.',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.Input_Array = {\r\n      name: 'Input Array',\r\n      description: 'The user can complete a form corresponding to the Form Inputs given (arrayOf), as many time as he wants. For example, if you want to have a field with the list of contacts, you can create a Form Input Array with all Form Inputs related to the creation of a contact. The user can complete the form as many time as he has contacts. The properties below help to bound the behavior of the element to what you want it to be !',\r\n      properties: [\r\n        { name: 'enum', type: 'array', arrayOf: [ 'enum' ] },\r\n        { name: 'array of', keyName: 'arrayOf', type: 'array', arrayOf: [ 'Input_' ], required: true, escription: 'All the Form Inputs the array should contain.' }\r\n      ],\r\n      value: {\r\n        name: 'array',\r\n        type: 'array',\r\n        arrayOf: [ 'object' ],\r\n        description: 'An array of object containing every values with the id of the Form Inputs as its keys.',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.Input_Object = {\r\n      name: 'Input Object',\r\n      description: 'Ask the user to return the values of multiple Form Inputs throught a form. It acts like a folder of Form Inputs. It allows you to categorise the form. his object will have to match the properties that you will set below.',\r\n      properties: [\r\n        { name: 'enum', type: 'array', arrayOf: [ 'enum' ] },\r\n        { name: 'object of', keyName: 'objectOf', type: 'array', arrayOf: [ 'Input_' ], required: true, description: 'The list of Form Inputs (can include other Form Input Object) to categorize.' }\r\n      ],\r\n      value: {\r\n        name: 'object',\r\n        type: 'object',\r\n        description: 'An object with the returned value of every Form Input with their id as key.',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.Input_Selector = {\r\n      name: 'Input Selector',\r\n      properties: [\r\n        { name: 'selector of', keyName: 'selectorOf', type: 'array', arrayOf: [ 'selection' ], required: true, description: \"You (or the user if allowed) can select an object of Form Inputs to complete. It's a big select of group of Form Inputs. For example if the user tells you he loves bike, you might want him to fulfill the caracteristics of his favorite bike, instead of completing those of a car.\" },\r\n        { name: 'by user', keyName: 'byUser', type: 'bool', default: true, description: 'Can the user change himself the selection ?' },\r\n        { name: 'selectorIndex', type: 'number', description: 'The id of the current Selection. This can define the default selection and even allow you to change it according to some logic.' } //if allowUser is false and then required\r\n      ],\r\n      value: {\r\n        name: 'selection',\r\n        type: 'selection',\r\n        description: \"An object containing all the returned values (corresponding to the Form Inputs of the current Selection) given by user, with the Form Inputs's ids as its keys.\",\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.Input_Blueprint = {\r\n      name: 'Input Blueprint',\r\n      description: 'Load another Blueprint (with you can interact throught \"Parameters\") like if you have create it right here into this Blueprint. This allows you to not repeting yourselft and to maintain your work easily.',\r\n      properties: [ //to fullfill with the sidenav or a dialog\r\n        { name: 'Blueprint id', type: 'number', required: true, description: 'The id of the Blueprint being fetched. You can set it manually or via the right sidenav (Tab \"Element\").' },\r\n        { name: 'Parameters', type: 'array', arrayOf: [ 'property' ], description: 'All the Properties the Blueprint requests. They correspond to external variables. Some should be given if required, others are optional. Each of these Properties must have their property \"key\" corresponding to the property \"key\" of the Parameter given in the Blueprint fetched by this Form Input Blueprint.' }\r\n      ],\r\n      value: {\r\n        name: 'Return Values',\r\n        description: 'All the values the Blueprint thinks you should have. You can, like with any object, extract a value by connecting a Property which has its property \"key\" matching the property \"key\" of the Return (from the Blueprint fetched) giving the value.',\r\n        type: 'object', //all the outputs\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n  };\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').service('functionsElements', [ function() {\r\n\r\n  this.addTo = function(elementsDefinition) { //the service 'elementsDefinition' calls the method 'add' of every services with blueprint elements with 'this' as the parameter. So 'elementsDefinition' gains more keys and can hold every elements\r\n\r\n    elementsDefinition.concat = {\r\n      name: 'Concat',\r\n      properties: [\r\n        { name: 'strings', type: 'array', arrayOf: [ 'string' ], required: true },\r\n        { name: 'separator', type: 'string' }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'string',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values.strings.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n            return (typeof values.separator !== 'undefined') ? previousValue += values.separator + currentValue : previousValue += currentValue;\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.matchByString = {\r\n      name: 'Match by String',\r\n      properties: [\r\n        { name: 'string(s)', keyName: 'strings', type: 'array', arrayOf: [ 'string' ], required: true },\r\n        { name: 'match string(s)', keyName: 'matchStrings', type: 'array', arrayOf: [ 'string' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'bool',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values.matchStrings.every(function(matchString, index, array) {\r\n            return values.strings.every(function(string, index, array) {\r\n              return string.indexOf(matchString) > -1;\r\n            });\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.matchByRegHex = {\r\n      name: 'Match by RegHex',\r\n      properties: [\r\n        { name: 'string(s)', keyName: 'strings', type: 'array', arrayOf: [ 'string' ], required: true },\r\n        { name: 'match(s)', keyName: 'matchs', type: 'array', arrayOf: [ 'RegHex' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'bool',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values.matchs.every(function(match, index, array) {\r\n            return values.strings.every(function(string, index, array) {\r\n              return (string.match(match)) ? true : false; //match return null if the string does not match else an array\r\n            });\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.indexOf = {\r\n      name: 'Index of',\r\n      properties: [\r\n        { name: 'array(s)', keyName:'arrays', type: 'array', arrayOf: [ 'array' ], required: true },\r\n        { name: 'element(s) to find', keyName: 'elements', type: 'array', arrayOf: [ 'mixed' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'bool',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values.elements.every(function(element) {\r\n            return values.arrays.every(function(array) {\r\n              return array.indexOf(element) > -1;\r\n            });\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n  };\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').service('opperatorsElements', [ function() {\r\n\r\n  this.addTo = function(elementsDefinition) { //the service 'elementsDefinition' calls the method 'add' of every services with blueprint elements with 'this' as the parameter. So 'elementsDefinition' gains more keys and can hold every elements\r\n\r\n    elementsDefinition.addition = {\r\n      name: 'Addition',\r\n      properties: [\r\n        { name: 'numbers', type: 'array', arrayOf: [ 'number', 'date' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'sum',\r\n        type: 'mixed',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n         return values.numbers.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n           return previousValue + currentValue;\r\n         }); //return the last returned value so the sum\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.substraction = {\r\n      name: 'Substraction',\r\n      properties: [\r\n        { name: 'number(s)', keyName: 'minuends', type: 'array', arrayOf: [ 'number', 'date' ], required: true }, //the key in values will be the keyName if exists or the name\r\n        { name: '- number(s)', keyName: 'substrahends', type: 'array', arrayOf: [ 'number', 'date' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'difference',\r\n        type: 'mixed',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          var sumMinuends = values.minuends.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n            return previousValue + currentValue;\r\n          });\r\n\r\n          var sumSubstrahends = values.substrahends.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n            return previousValue + currentValue;\r\n          }); //return the last returned value so the sum\r\n\r\n          return sumMinuends - sumSubstrahends;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.multiplication = {\r\n      name: 'Multiplication',\r\n      properties: [\r\n        { name: 'numbers', type: 'array', arrayOf: [ 'number', 'date' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'product',\r\n        type: 'mixed',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n         return values.numbers.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n           return previousValue * currentValue;\r\n         }); //return the last returned value so the product\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.division = {\r\n      name: 'Division',\r\n      properties: [\r\n        { name: 'numerator(s)', keyName: 'numerators', type: 'array', arrayOf: [ 'number', 'date' ], required: true },\r\n        { name: 'denominator(s)', keyName: 'denominators', type: 'array', arrayOf: [ 'number', 'date' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'quotient',\r\n        type: 'mixed',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          var ProductNumerators = values.numerators.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n            return previousValue + currentValue;\r\n          });\r\n\r\n          var ProductDenominators = values.denominators.reduce(function(previousValue, currentValue, index, array) { //the previousValue is the value returned by the call of this function for the previous element of the array\r\n            return previousValue + currentValue;\r\n          }); //return the last returned value so the quotient\r\n\r\n          return ProductNumerators / ProductDenominators;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.modulo = {\r\n      name: 'Modulo',\r\n      properties: [\r\n        { name: 'number', keyName: 'number', type: 'array', arrayOf: [ 'number', 'date' ], required: true },\r\n        { name: '% number', keyName: 'modulator', type: 'array', arrayOf: [ 'number', 'date' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'module',\r\n        type: 'mixed',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values.number % values.modulator;\r\n        }\r\n      }\r\n    };\r\n\r\n  };\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').service('parametersElements', [ function() {\r\n\r\n  this.addTo = function(elementsDefinition) { //the service 'elementsDefinition' calls the method 'add' of every services with blueprint elements with 'this' as the parameter. So 'elementsDefinition' gains more keys and can hold every elements\r\n\r\n    elementsDefinition.enum = {\r\n      name: 'Enum',\r\n      properties: [\r\n        { name: 'name', type: 'string', required: true },\r\n        { name: 'description', type: 'string' },\r\n        { name: 'value', type: 'mixed', required: true }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'enum',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.property = { //need one for in and an other for out an object\r\n      name: 'Property',\r\n      properties: [\r\n        { name: 'name', type: 'string', required: true },\r\n        { name: 'value', type: 'mixed', required: true }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'property',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.RegHex = {\r\n      name: 'RegHex',\r\n      properties: [\r\n        { name: 'motif', type: 'string', required: true },\r\n        { name: 'flags', type: 'string' },\r\n        { name: 'helper', type: 'string' }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'RegHex',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    //one choice for a Input_Selector\r\n    elementsDefinition.selection = {\r\n      name: 'Selection',\r\n      properties: [\r\n        { name: 'name', type: 'string', required: true },\r\n        { name: 'description', type: 'string' },\r\n        { name: 'value', type: 'array', arrayOf: [ 'Input_' ], required: true }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'selection',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.boolOption = {\r\n      name: 'Bool Option',\r\n      properties: [\r\n        { name: 'label', type: 'string' },\r\n        { name: 'value', type: 'mixed' }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'boolOption',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          return values;\r\n        }\r\n      }\r\n    };\r\n\r\n  };\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').service('primaryElements', [ function() {\r\n\r\n  this.addTo = function(elementsDefinition) { //the service 'elementsDefinition' calls the method 'add' of every services with blueprint elements with 'this' as the parameter. So 'elementsDefinition' gains more keys and can hold every elements\r\n\r\n    elementsDefinition.array = {\r\n      name: 'Array',\r\n      properties: [\r\n        { name: 'type', type: 'string', required: true }\r\n      ],\r\n      value: {\r\n        name: 'array',\r\n        type: 'array', //all the outputs\r\n        arrayOf: [ 'mixed' ],\r\n        in: {\r\n          type: 'array', //all the inputs\r\n          arrayOf: [ 'mixed' ]\r\n        },\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.bool = {\r\n      name: 'Bool',\r\n      properties: [],\r\n      value: {\r\n        name: 'bool',\r\n        type: 'bool', //all the outputs\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.date = {\r\n      name: 'Date',\r\n      properties: [],\r\n      value: {\r\n        name: 'date',\r\n        type: 'date', //all the outputs\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.number = {\r\n      name: 'Number',\r\n      properties: [],\r\n      value: {\r\n        name: 'number',\r\n        type: 'number', //all the outputs\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.object = {\r\n      name: 'Object',\r\n      properties: [],\r\n      value: {\r\n        name: 'object',\r\n        type: 'object', //all the outputs\r\n        in: {\r\n          type: 'array', //all the inputs\r\n          arrayOf: [ 'property' ]\r\n        },\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.string = {\r\n      name: 'String',\r\n      properties: [],\r\n      value: {\r\n        name: 'string',\r\n        type: 'string', //all the outputs\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.mixed = { //to avoid any problem when reachingthe name corresponding to an element type\r\n      name: '*',\r\n      properties: [],\r\n      value: {\r\n        name: 'string',\r\n        type: 'string', //all the outputs\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //return values;\r\n        }\r\n      }\r\n    };\r\n\r\n  };\r\n\r\n}]);\r\n\r\n\r\nangular.module('GMAO Tailor').service('variablesElements', [ function() {\r\n\r\n  this.addTo = function(elementsDefinition) { //the service 'elementsDefinition' calls the method 'add' of every services with blueprint elements with 'this' as the parameter. So 'elementsDefinition' gains more keys and can hold every elements\r\n\r\n    elementsDefinition.parameter = {\r\n      name: 'Parameter',\r\n      properties: [\r\n        { name: 'key', type: 'string', required: true },\r\n        { name: 'type', type: 'string', required: true, default: 'string', enum: [] }, //enum = all keys of elementsDefinition\r\n        { name: 'required', type: 'bool', default: 'false' }\r\n      ],\r\n      value: {\r\n        name: 'value',\r\n        type: 'mixed',\r\n        get: function(values) { //values: object containing all the values of the properties\r\n          //to do\r\n        }\r\n      }\r\n    };\r\n\r\n    elementsDefinition.return = {\r\n      name: 'Return',\r\n      properties: [\r\n        { name: 'key', type: 'string', required: true },\r\n        { name: 'value', type: 'mixed', required: true }\r\n      ]\r\n    };\r\n\r\n  };\r\n\r\n}]);\r\n"]}